<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19085" />

<meta name="date" content="2020-01-02" />

<title>Homework_summary</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework_summary</h1>
<h4 class="author">19085</h4>
<h4 class="date">2020-01-02</h4>



<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="exercise-3.4" class="section level2">
<h2>Exercise 3.4</h2>
<p>We use the inverse transform method to generate random number from a Rayleigh distribution. For Rayleigh distribution, when <span class="math inline">\(\mathrm{x} \geq 0, \sigma&gt;0\)</span>, its distribution function is: <span class="math display">\[
\mathrm{F}(\mathrm{x})=1-e^{-\frac{x^{2}}{2 \sigma^{2}}}
\]</span> the inverse function of its ditribution function is:</p>
<p><span class="math display">\[
F^{-1}(\mathrm{x})=\sqrt{-2 \sigma^{2} \ln (1-x)} \quad 0&lt;x&lt;1
\]</span> So that if <span class="math inline">\(U\)</span> is a randon variable of uniform distribution in <span class="math inline">\([0,1]\)</span>, then random variable <span class="math inline">\(F^{-1}(U)\)</span> obey Rayleigh distribution.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># specify sigma from 1 to 5</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="cf">for</span>(sigma <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="co"># generate 2000 random numbers from uniform distribution</span></a>
<a class="sourceLine" id="cb1-4" title="4">  U&lt;-<span class="kw">runif</span>(<span class="dv">2000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="co"># generate random numbers from Rayleigh distribution using inverse transform</span></a>
<a class="sourceLine" id="cb1-6" title="6">  rand_num&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>U))</a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="co"># draw the histogram of the random numbers.</span></a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">hist</span>(rand_num,<span class="dt">prob=</span>T,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;sigma=&#39;</span>,sigma,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>))</a>
<a class="sourceLine" id="cb1-9" title="9">  <span class="co"># draw the density function of Rayleigh distribution</span></a>
<a class="sourceLine" id="cb1-10" title="10">  x&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb1-11" title="11">  <span class="kw">lines</span>(x,x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb1-12" title="12">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.11" class="section level2">
<h2>Exercise 3.11</h2>
<p>Firstly, we generate 1000 random numbers from Bernoulli distribution with probability equals to 0.75, then we generate 1000 random numbers from normal distribution <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> respectively, finally we combine them to generate the mixed distribution.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># generate 1000 random numbers from Bernoulli distribution</span></a>
<a class="sourceLine" id="cb2-2" title="2">b&lt;-<span class="kw">rbinom</span>(<span class="dt">n=</span><span class="dv">1000</span>,<span class="dt">size=</span><span class="dv">1</span>,<span class="dt">prob =</span> <span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co"># generate 1000 random numbers from normal distribution N(0,1)</span></a>
<a class="sourceLine" id="cb2-4" title="4">N1&lt;-<span class="kw">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># generate 1000 random numbers from normal distribution N(3,1)</span></a>
<a class="sourceLine" id="cb2-6" title="6">N2&lt;-<span class="kw">rnorm</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># combine them to generate the mixed distribution</span></a>
<a class="sourceLine" id="cb2-8" title="8">rand_num_mixed&lt;-b<span class="op">*</span>N1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>b)<span class="op">*</span>N2</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co"># draw the histogram and the density line of the random numbers</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw">hist</span>(rand_num_mixed,<span class="dt">breaks =</span><span class="dv">100</span>,<span class="dt">probability =</span>T)</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">lines</span>(<span class="kw">density</span>(rand_num_mixed))</a></code></pre></div>
<p><img src="data:image/png;base64,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ekhbGkD6Ne2eM/ZGBGlwQl+p97c426/oTw3VKT3Id04sHOa9uRv5PEjt3sm4i71sfB6AJor+3EbembQIUtYWnnFKCEj3AReE0r/UALm1/EuNasRipS9arAIRICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBJQDILSvDMg6cyWuYakLALSsYQIElArQ4c17sYeyUFvADruvdmovmNj08t5qh7ki+w3/8bIRv2/FHnmrI3W+lS+C57blmyxLs8Olb3iukgHaiZ07YgeZ2Et52Ilt8/yf2NZbsQ4gdaUFJDfY82T29rzOtyKpeRm8sCm3Wp0Ynqt0gLbCjR7VbkT5G/+gdiYWHUDqSgtoq3eX2bsvO9/KpNX1j28e9etQq+ufTg3PVTpAzdlMVgdSGwarDiB1pQX0oNl0AVnfKtOF2CKsLPHvTg3PVVpAPDBc/2vTAirjAapEjKrMTtdTw3OVFFDTrvgedNz/WUQdY+lMPUhWu+qMUdKvBgFZUWoEoPL2/zxONx351PBcJfegw45tGwyyCb1RTF057m+fj3s2FpD4J/BLJIUeIs9sFDOznseiHcSH5kH6ijhP7qvRXayQW6Dv1DxIdq9zmwedrQgQUB6AxJoBb6Qflyqy8gCUsQgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAjoN1VyrYfng/2pAAAAAElFTkSuQmCC" /><!-- --></p>
<p>Now, we draw the mixed distribution with probability equals to 0.5.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the pictuer above, we can figure out that When the probality equals to 0.5, the mixed distribution will be a bimodol distribution.</p>
</div>
<div id="exercise-3.18" class="section level2">
<h2>Exercise 3.18</h2>
<p>We write function <strong>Wishart</strong> to generate a random sample from Wishart distribution, to use Bartlettâ€™s decomposition we need to specify three parameters including:</p>
<ul>
<li><p>Sigma: the covariance matrix.</p></li>
<li><p>n: the number of matrix to be added satisfing <span class="math inline">\(\mathrm{n}&gt;\mathrm{d}+1 \geq 1\)</span>.</p></li>
<li><p>d: the dimension of the random vector satisfing <span class="math inline">\(\mathrm{d}\geq 0\)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">Wishart&lt;-<span class="cf">function</span>(Sigma,n,d){</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="cf">if</span> (<span class="kw">missing</span>(d)) d&lt;-<span class="kw">ncol</span>(Sigma) </a>
<a class="sourceLine" id="cb3-3" title="3">   <span class="cf">if</span>(<span class="kw">missing</span>(n)) n&lt;-d<span class="op">+</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-4" title="4">   <span class="co"># generate the matrix with diagnal entries obey the Chi-square distibution </span></a>
<a class="sourceLine" id="cb3-5" title="5">   <span class="co"># and off-diagnal entries obey normal distribution.</span></a>
<a class="sourceLine" id="cb3-6" title="6">  T&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>d,<span class="dt">ncol=</span>d)</a>
<a class="sourceLine" id="cb3-7" title="7">  T[<span class="dv">1</span>,<span class="dv">1</span>]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df=</span>n))</a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb3-9" title="9">    T[i,i]&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df=</span>n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>){</a>
<a class="sourceLine" id="cb3-11" title="11">      T[i,j]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-12" title="12">    }</a>
<a class="sourceLine" id="cb3-13" title="13">  }</a>
<a class="sourceLine" id="cb3-14" title="14">  </a>
<a class="sourceLine" id="cb3-15" title="15">  A&lt;-T<span class="op">%*%</span><span class="kw">t</span>(T)</a>
<a class="sourceLine" id="cb3-16" title="16">  <span class="co"># calculate the cholesky decomposition of matrix Sigma. </span></a>
<a class="sourceLine" id="cb3-17" title="17">  L&lt;-<span class="kw">chol</span>(Sigma)</a>
<a class="sourceLine" id="cb3-18" title="18">  <span class="kw">return</span>(<span class="kw">t</span>(L)<span class="op">%*%</span>A<span class="op">%*%</span>L)</a>
<a class="sourceLine" id="cb3-19" title="19">}</a></code></pre></div>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="exercise-5.1" class="section level2">
<h2>exercise 5.1</h2>
<p>To compute a Monte Carlo estimate <span class="math inline">\(\hat{\theta}\)</span> of <span class="math inline">\(\theta=\int_{0}^{\pi / 3} \sin t d t\)</span>, we creat function <strong>Monte_carlo</strong>, the parameter of this function is <strong>n</strong>, which represents the number of replicates. we notice that <span class="math inline">\(\theta=\frac{\pi}{3}*E(\sin X)\ \ X \sim \mathrm{U}[0,\pi/3]\)</span>, so that we use sample mean to estimate the mean of the population.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">Monte_carlo&lt;-<span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1468</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co"># generate n random number from distribution U[0,pi/3]</span></a>
<a class="sourceLine" id="cb4-4" title="4">r&lt;-<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co"># use the sample mean to estimate the population mean</span></a>
<a class="sourceLine" id="cb4-6" title="6">MC_value&lt;-pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span><span class="kw">mean</span>(<span class="kw">sin</span>(r))</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co"># calcullate the true value use function: integrate</span></a>
<a class="sourceLine" id="cb4-8" title="8">true_value&lt;-<span class="kw">integrate</span>(sin,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">return</span>(<span class="kw">c</span>(MC_value,true_value))</a>
<a class="sourceLine" id="cb4-10" title="10">}</a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co"># simulation </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="kw">Monte_carlo</span>(<span class="dv">1000000</span>)</a></code></pre></div>
<pre><code>## [1] 0.4999351 0.5000000</code></pre>
</div>
<div id="exercise-5.10" class="section level2">
<h2>exercise 5.10</h2>
<p>To use Monte Carlo integration with anithetic variables to estimate <span class="math inline">\(\theta=\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\)</span>, and find the approximate reduction in variance as percentage in contrast with ordinary Monte Carlo method, we creat function <strong>antithetic_contrast</strong>, the only parameter of this function is <strong>m</strong> which represents the number of replicates.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># library(knitr)</span></a>
<a class="sourceLine" id="cb6-2" title="2">antithetic_contrast&lt;-<span class="cf">function</span>(m){</a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="co"># m should be an even </span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="cf">if</span>(m<span class="op">%%</span><span class="dv">2</span><span class="op">!=</span><span class="dv">0</span>) m&lt;-m<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="kw">set.seed</span>(<span class="dv">1467</span>)</a>
<a class="sourceLine" id="cb6-7" title="7">  f&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-8" title="8">  r1&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="co"># calculate the estimate of ordinary Monte Carlo integration and its variance </span></a>
<a class="sourceLine" id="cb6-10" title="10">  MC_value&lt;-<span class="kw">mean</span>(<span class="kw">f</span>(r1))</a>
<a class="sourceLine" id="cb6-11" title="11">  MC_var&lt;-<span class="dv">1</span><span class="op">/</span>m<span class="op">*</span><span class="kw">var</span>(<span class="kw">f</span>(r1))</a>
<a class="sourceLine" id="cb6-12" title="12">  </a>
<a class="sourceLine" id="cb6-13" title="13">  g&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">exp</span>(x<span class="dv">-1</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-14" title="14">  r2&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-15" title="15">  <span class="co"># calculate the estimate of Monte Carlo integration with anithetic variables and its variance </span></a>
<a class="sourceLine" id="cb6-16" title="16">  Anti_value&lt;-<span class="dv">1</span><span class="op">/</span>m<span class="op">*</span><span class="kw">sum</span>(<span class="kw">g</span>(r2))</a>
<a class="sourceLine" id="cb6-17" title="17">  Anti_var&lt;-<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m)<span class="op">*</span><span class="kw">var</span>(<span class="kw">g</span>(r2))</a>
<a class="sourceLine" id="cb6-18" title="18">  result&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(MC_value,Anti_value),<span class="kw">c</span>( MC_var,Anti_var))</a>
<a class="sourceLine" id="cb6-19" title="19">  <span class="kw">rownames</span>(result)&lt;-<span class="kw">c</span>(<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;variance&#39;</span>)</a>
<a class="sourceLine" id="cb6-20" title="20">  <span class="co"># output the reduction of variance in percentage</span></a>
<a class="sourceLine" id="cb6-21" title="21">  <span class="kw">cat</span>(<span class="st">&#39;the reduction in variance is&#39;</span>,<span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span>(MC_var<span class="op">-</span>Anti_var)<span class="op">/</span><span class="st"> </span>MC_var,<span class="dv">2</span>),<span class="st">&#39;%&#39;</span>)</a>
<a class="sourceLine" id="cb6-22" title="22">  knitr<span class="op">::</span><span class="kw">kable</span>(result, <span class="dt">format =</span> <span class="st">&#39;html&#39;</span>, <span class="dt">row.names =</span> T, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&#39;MC&#39;</span>,<span class="st">&#39;Anti&#39;</span>))</a>
<a class="sourceLine" id="cb6-23" title="23"> </a>
<a class="sourceLine" id="cb6-24" title="24">} </a>
<a class="sourceLine" id="cb6-25" title="25"></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="kw">antithetic_contrast</span>(<span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## the reduction in variance is 96.35 %</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
MC
</th>
<th style="text-align:right;">
Anti
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:right;">
0.5309131
</td>
<td style="text-align:right;">
0.5251019
</td>
</tr>
<tr>
<td style="text-align:left;">
variance
</td>
<td style="text-align:right;">
0.0000611
</td>
<td style="text-align:right;">
0.0000022
</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-5.15" class="section level2">
<h2>exercise 5.15</h2>
<p>We use Stratified Importance sampling to estimate<br />
<span class="math display">\[
\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x
\]</span></p>
<p>firstly, we divide the interval <span class="math inline">\([0,1]\)</span> into five subintervals by the four fifth-quanliles of the population: <span class="math display">\[
\mathrm{F}(\mathrm{x})=\frac{1-e^{-x}}{1-e^{-1}} \quad 0 \leq x \leq 1
\]</span> <strong>quant</strong> is the result, with its first number 0 and last number 1, then in each subinterval, the sampling function which also represents the density function of the random variable in each interval changes to <span class="math display">\[
\frac{5e^{-x}}{1-e^{-1}}
\]</span></p>
<p>at the same time, the expectation we want to calculate in each subinterval is <span class="math display">\[
\mathrm{E}\left(\frac{1-e^{-1}}{5\left(1+X^{2}\right)}\right)
\]</span></p>
<p>to generate random number satisfing our demand, we use acceptance-rejection method, in each subinterval, we calculate the optimal <strong>c</strong>, for <strong>g</strong>, we specified it to be the density function of uniform distridution in each subinterval, and due to the whole number of replicates is 10000, in each subinterval, we generate 2000 random numbers. we repeat the estimate 100 times and use the sample standard deviation to estimate standard deviation of population.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">F&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>x))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co"># distribution function</span></a>
<a class="sourceLine" id="cb8-2" title="2">F_inverse&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>x)) <span class="co"># the inverse function of distribution function</span></a>
<a class="sourceLine" id="cb8-3" title="3">G&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>((<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>))) <span class="co"># the function of the random variable, we want to calculate its expectation</span></a>
<a class="sourceLine" id="cb8-4" title="4">f&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) <span class="co"># density function of random variable in each subinterval</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6">quant&lt;-<span class="kw">F_inverse</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)) <span class="co"># interval endpoints of the 5 subintervals</span></a>
<a class="sourceLine" id="cb8-7" title="7">g&lt;-(quant[<span class="op">-</span><span class="dv">1</span>]<span class="op">-</span>quant[<span class="op">-</span><span class="dv">6</span>])<span class="op">^-</span><span class="dv">1</span> <span class="co"># the density function of uniform distridution in each subinterval</span></a>
<a class="sourceLine" id="cb8-8" title="8">theta_hat&lt;-<span class="kw">numeric</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb8-10" title="10">theta&lt;-<span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb8-12" title="12">  <span class="co"># use acceptance-rejection method to generate the random number</span></a>
<a class="sourceLine" id="cb8-13" title="13"> </a>
<a class="sourceLine" id="cb8-14" title="14">  random_vector&lt;-<span class="kw">numeric</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb8-15" title="15">  </a>
<a class="sourceLine" id="cb8-16" title="16">  c&lt;-<span class="kw">f</span>(quant[i])<span class="op">/</span>g[i]</a>
<a class="sourceLine" id="cb8-17" title="17">  <span class="cf">while</span> (<span class="kw">length</span>(random_vector)<span class="op">&lt;</span><span class="dv">2000</span>) {</a>
<a class="sourceLine" id="cb8-18" title="18">    Y&lt;-<span class="kw">runif</span>(<span class="dv">1</span>,<span class="dt">min=</span>quant[i],<span class="dt">max=</span>quant[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb8-19" title="19">    U&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-20" title="20">    <span class="cf">if</span>(U<span class="op">&lt;</span>(<span class="kw">f</span>(Y)<span class="op">/</span>(c<span class="op">*</span>g[i]))) random_vector&lt;-<span class="kw">c</span>(random_vector,Y)</a>
<a class="sourceLine" id="cb8-21" title="21">  }</a>
<a class="sourceLine" id="cb8-22" title="22">  </a>
<a class="sourceLine" id="cb8-23" title="23">  theta[i]&lt;-<span class="kw">mean</span>(<span class="kw">G</span>(random_vector))</a>
<a class="sourceLine" id="cb8-24" title="24">  </a>
<a class="sourceLine" id="cb8-25" title="25">}</a>
<a class="sourceLine" id="cb8-26" title="26"></a>
<a class="sourceLine" id="cb8-27" title="27"></a>
<a class="sourceLine" id="cb8-28" title="28">theta_hat[k]&lt;-<span class="kw">sum</span>(theta)</a>
<a class="sourceLine" id="cb8-29" title="29">}</a>
<a class="sourceLine" id="cb8-30" title="30"><span class="kw">list</span>(<span class="dt">theta_hat=</span>theta_hat,<span class="dt">sd=</span><span class="kw">sd</span>(theta_hat))</a></code></pre></div>
<pre><code>## $theta_hat
##   [1] 0.5244339 0.5250961 0.5248561 0.5247159 0.5252282 0.5248302 0.5244245
##   [8] 0.5251934 0.5247959 0.5252135 0.5247152 0.5249835 0.5249153 0.5253774
##  [15] 0.5252727 0.5247324 0.5244989 0.5250270 0.5249538 0.5250044 0.5249563
##  [22] 0.5246939 0.5248296 0.5247398 0.5251061 0.5248749 0.5246742 0.5247071
##  [29] 0.5250560 0.5249698 0.5247177 0.5245872 0.5245111 0.5246228 0.5247298
##  [36] 0.5248645 0.5244207 0.5246032 0.5248007 0.5249764 0.5249001 0.5248075
##  [43] 0.5246228 0.5247314 0.5250079 0.5246083 0.5247844 0.5249668 0.5246882
##  [50] 0.5242701 0.5247037 0.5247682 0.5249360 0.5247999 0.5248149 0.5248153
##  [57] 0.5247189 0.5246985 0.5247566 0.5248079 0.5246221 0.5246984 0.5246029
##  [64] 0.5247383 0.5249918 0.5249601 0.5246674 0.5245357 0.5250898 0.5250272
##  [71] 0.5246907 0.5248698 0.5250031 0.5250786 0.5247704 0.5247862 0.5251578
##  [78] 0.5248909 0.5248648 0.5239966 0.5250195 0.5248926 0.5247029 0.5246634
##  [85] 0.5246765 0.5249513 0.5247820 0.5249862 0.5247178 0.5250190 0.5248805
##  [92] 0.5245516 0.5244798 0.5247317 0.5246369 0.5249463 0.5245422 0.5251594
##  [99] 0.5249802 0.5247940
## 
## $sd
## [1] 0.0002200836</code></pre>
<p>from the result we can figure out that importance sampling with stratified has a prominent standard deviation reduction in contrast with the one without stratified, the original standard deviation is 0.0970314, meanwhile, the estimation becomes more accurate.</p>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="exercise-6.5" class="section level2">
<h2>exercise 6.5</h2>
<ul>
<li>empirical confidence level for mean</li>
</ul>
<p>This question means that we should use a Monte Carlo experiment to estimate the coverage probability of the 95% symmetric t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> dataï¼Œto see the probability that the confidence interval covers the mean is higher or lower than 0.95. firstly according to the sampling distribution theorem, if the samle is normal distribution, then:</p>
<p><span class="math display">\[
\frac{\bar{X}-\mu}{S / \sqrt{n}} \sim t(n-1)
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is population mean, for <span class="math inline">\(\chi^{2}(2)\)</span>, it equals to 2, <span class="math inline">\(\bar{X}\)</span> is sample mean, <span class="math inline">\(S\)</span> is the sample variance, <span class="math inline">\(n\)</span> is the number of samples. so the 95% symmetric t-interval for population mean <span class="math inline">\(\mu\)</span> is:</p>
<p><span class="math display">\[
\left[\bar{X}-S / \sqrt{n} t_{1-\frac{a}{2}}(n-1), \bar{X}-S / \sqrt{n} t_{\frac{a}{2}}(n-1)\right]
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is the significance level, we creat function cpt to return the empirical confidence level for mean, the parameter of cpt is :</p>
<ul>
<li>m: the number of random experiment
<ul>
<li>n: the number of random numbers generated in each experiment</li>
<li>alpha: the significance level.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">cpt&lt;-<span class="cf">function</span>(m,<span class="dt">n=</span><span class="dv">20</span>,<span class="dt">alpha=</span><span class="fl">0.05</span>){</a>
<a class="sourceLine" id="cb10-2" title="2"> </a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="co"># generate matrix of random numbers of dim m*n</span></a>
<a class="sourceLine" id="cb10-4" title="4">  chisq&lt;-<span class="kw">matrix</span>(<span class="kw">rchisq</span>(m<span class="op">*</span>n,<span class="dt">df=</span><span class="dv">2</span>),<span class="dt">nrow =</span> m,<span class="dt">ncol =</span> n)</a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="co"># calculate the symmetric t confidence interval according to each row of random numbers</span></a>
<a class="sourceLine" id="cb10-6" title="6">  interval_cal&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb10-7" title="7">                                 <span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)))</a>
<a class="sourceLine" id="cb10-8" title="8">  interval_matix&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(chisq,<span class="dv">1</span>,interval_cal))</a>
<a class="sourceLine" id="cb10-9" title="9">  <span class="co"># calculate the empirical confidence level</span></a>
<a class="sourceLine" id="cb10-10" title="10">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>m<span class="op">*</span><span class="kw">sum</span>(<span class="dv">2</span><span class="op">&gt;</span><span class="st"> </span>interval_matix[,<span class="dv">1</span>]<span class="op">&amp;</span><span class="dv">2</span><span class="op">&lt;</span>interval_matix[,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb10-11" title="11">  </a>
<a class="sourceLine" id="cb10-12" title="12">}</a>
<a class="sourceLine" id="cb10-13" title="13"><span class="kw">cpt</span>(<span class="dt">m=</span><span class="dv">1000</span>)</a></code></pre></div>
<pre><code>## [1] 0.953</code></pre>
<p>from the result, the empirical confidence level is close to 0.95, so that the interval estimation for mean is not sensitive to departures from normality.</p>
<ul>
<li>empirical confidence level for variance</li>
</ul>
<p>in order to compared with example 6.4, we conduct 1000 random experiments too, and calculate empirical confidence intervals for variance: <span class="math display">\[
\left(0,(n-1) S^{2} / \chi_{\alpha}^{2}\right)
\]</span> for <span class="math inline">\(\chi^{2}(2)\)</span>, the variance is 4.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">upper_bound&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb12-2" title="2">  n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb12-3" title="3">  alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb12-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb12-6" title="6">})</a>
<a class="sourceLine" id="cb12-7" title="7">cpt_variance&lt;-<span class="kw">mean</span>(upper_bound<span class="op">&gt;</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">cat</span>(<span class="st">&#39;the empirical confidence level for variance is:&#39;</span>, cpt_variance)</a></code></pre></div>
<pre><code>## the empirical confidence level for variance is: 0.777</code></pre>
<p>from the result, we know that if the population donâ€™t obey normal istribution, the empirical confidence level for variance is far lower than 0.95, so that The t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="exercise-6.6" class="section level2">
<h2>exercise 6.6</h2>
<p>to estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness under normality by a Monte Carlo experiment, we creat function skew_quant, we use formula 2.14:</p>
<p><span class="math display">\[
\operatorname{Var}\left(\hat{x}_{q}\right)=\frac{q(1-q)}{n f\left(x_{q}\right)^{2}}
\]</span> to calculate variance of the q sample quantile, where <span class="math inline">\(f\)</span> is the pdf of <span class="math inline">\(N(0,6 / n)\)</span>, <span class="math inline">\(x_{q}\)</span> is the true q-quantile of skewness, the parameter of skew_quant is:</p>
<ul>
<li>m: the number of random experiments
<ul>
<li>n: the number of random numbers generated in each experiment</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">skew_quant&lt;-<span class="cf">function</span>(m,n){</a>
<a class="sourceLine" id="cb14-2" title="2">  </a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="co"># f is the pdf of N(0,6/n)</span></a>
<a class="sourceLine" id="cb14-4" title="4">  f&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="kw">sqrt</span>(n<span class="op">/</span>(<span class="dv">12</span><span class="op">*</span>pi))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>n<span class="op">*</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">12</span>))</a>
<a class="sourceLine" id="cb14-5" title="5">  quant&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="co"># generate matrix of random numbers obey normal distribution </span></a>
<a class="sourceLine" id="cb14-7" title="7">  norm_matrix&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(m<span class="op">*</span>n),<span class="dt">nrow =</span> m,<span class="dt">ncol =</span> n)</a>
<a class="sourceLine" id="cb14-8" title="8">  skew&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="kw">mean</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="kw">sd</span>(x)<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb14-9" title="9">  skew_hat&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(norm_matrix,<span class="dv">1</span>,skew))</a>
<a class="sourceLine" id="cb14-10" title="10">  <span class="co"># calculate sample quantiles</span></a>
<a class="sourceLine" id="cb14-11" title="11">  skew_quant&lt;-<span class="kw">quantile</span>(skew_hat,<span class="dt">prob=</span>quant)</a>
<a class="sourceLine" id="cb14-12" title="12">  <span class="co"># true quantiles generate form normal distribution N(0,6/n)</span></a>
<a class="sourceLine" id="cb14-13" title="13">  true_quant&lt;-<span class="kw">qnorm</span>(quant,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb14-14" title="14">  <span class="co"># calculate the standard error of sample quantiles</span></a>
<a class="sourceLine" id="cb14-15" title="15">  skew_sd&lt;-<span class="kw">sqrt</span>(quant<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>quant)<span class="op">/</span>(n<span class="op">*</span><span class="kw">f</span>(true_quant)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb14-16" title="16"></a>
<a class="sourceLine" id="cb14-17" title="17">  <span class="kw">return</span>(<span class="kw">rbind</span>(skew_quant,true_quant,skew_sd))</a>
<a class="sourceLine" id="cb14-18" title="18">}</a>
<a class="sourceLine" id="cb14-19" title="19"></a>
<a class="sourceLine" id="cb14-20" title="20"><span class="kw">skew_quant</span>(<span class="dv">2000</span>,<span class="dv">500</span>)</a></code></pre></div>
<pre><code>##                  2.5%          5%        95%     97.5%
## skew_quant -0.2139475 -0.17904295 0.17677964 0.2067602
## true_quant -0.2147033 -0.18018469 0.18018469 0.2147033
## skew_sd     0.0130867  0.01035246 0.01035246 0.0130867</code></pre>
<p>from the above result, the estimated quantiles by Monte Carlo is close to real quantiles of the large sample approximation,and the standard deviation is both low for 0.025,0.05,0.95,0.975 sample quantiles.</p>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="section" class="section level2">
<h2>6.7</h2>
<p><strong>question</strong> :estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(Î½)\)</span>?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb16-2" title="2">sig &lt;-<span class="fl">0.05</span> <span class="co"># significance level</span></a>
<a class="sourceLine" id="cb16-3" title="3">m &lt;-<span class="dv">1000</span> <span class="co"># times of simulations</span></a>
<a class="sourceLine" id="cb16-4" title="4">n &lt;-<span class="dv">500</span> <span class="co"># number of replications in each simulation</span></a>
<a class="sourceLine" id="cb16-5" title="5">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sig<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb16-6" title="6"></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co"># sk is the fuction used to compute the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb16-8" title="8"></a>
<a class="sourceLine" id="cb16-9" title="9">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb16-10" title="10">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb16-11" title="11">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-12" title="12">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-13" title="13"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb16-14" title="14">}</a>
<a class="sourceLine" id="cb16-15" title="15"></a>
<a class="sourceLine" id="cb16-16" title="16">alpha&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="fl">0.5</span>) <span class="co"># parameter of symmetric beta distribution</span></a>
<a class="sourceLine" id="cb16-17" title="17">power&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(alpha))</a>
<a class="sourceLine" id="cb16-18" title="18"></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alpha)){</a>
<a class="sourceLine" id="cb16-20" title="20">   reject_i&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb16-21" title="21">   rand_num&lt;-<span class="kw">rbeta</span>(n,alpha[i],alpha[i])  </a>
<a class="sourceLine" id="cb16-22" title="22">   skew&lt;-<span class="kw">sk</span>(rand_num) </a>
<a class="sourceLine" id="cb16-23" title="23">   <span class="kw">as.integer</span>(<span class="kw">abs</span>(skew)<span class="op">&gt;=</span>cv) </a>
<a class="sourceLine" id="cb16-24" title="24">     </a>
<a class="sourceLine" id="cb16-25" title="25">   })</a>
<a class="sourceLine" id="cb16-26" title="26">   </a>
<a class="sourceLine" id="cb16-27" title="27">  power[i]&lt;-<span class="kw">mean</span>(reject_i)</a>
<a class="sourceLine" id="cb16-28" title="28">}</a>
<a class="sourceLine" id="cb16-29" title="29"><span class="kw">plot</span>(alpha ,power,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;alpha&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;power&#39;</span>, <span class="dt">main=</span><span class="st">&#39;power versus alpha for Beta(alpha,alpha)&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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/zUoHVB4HVKmfhCQRKO6ELcH1LsU3sSq8Cio0vtSvOevzinQVcPcKLuTHvT4uFAGqV+qBC69OvWAQV3ybT7UN3QKjqRFJxV86/ugPqjUgaJuQSCw8FSjRpOVddhAJ1dV5FTjVEWAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQULmAjL+QtX7OLAIERICACgS0VtvMOJTti28Xcj/LbvnlQu09W4f30qdXeYDE3i+xX1MAWnAYYl/vbim26fP/moP5VBwg+cZgsZlOApJ76283u+W9LGwP5lNxgIRqxjQguenw6lH2QbojqvO2sfIAVYxd/6oz6IXettoCag7mU3GAZNZsPYDag/lUHCC1G54ZfdBa9EEKUHswn4oDpJKH39slIP3XKWYGyYP5VBwgtUl3LZvVdqGHP2YfJA/mC6c8QIby9jZuESAgAgRUNKASRICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEB/Aa82ovxPfP+ZAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span> (<span class="kw">rbind</span>(alpha,power),<span class="dt">format =</span> <span class="st">&#39;html&#39;</span>,<span class="dt">row.names =</span> T,<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2.5
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.5
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
5.50
</td>
<td style="text-align:right;">
6.00
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
7.50
</td>
<td style="text-align:right;">
8.00
</td>
<td style="text-align:right;">
8.50
</td>
<td style="text-align:right;">
9.00
</td>
<td style="text-align:right;">
9.50
</td>
<td style="text-align:right;">
10.00
</td>
</tr>
<tr>
<td style="text-align:left;">
power
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
</tbody>
</table>
<p>from the result above, we can know that the power is lower than 0.05, and it has an increasing trend as alpha increase but not strictly, this is because skewness test mainly test symmetrical features of a distribution and beta distribution has this features.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># the degree of freedom of the T distribution</span></a>
<a class="sourceLine" id="cb18-2" title="2">v&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4">m &lt;-<span class="dv">1000</span> <span class="co"># times of simulations</span></a>
<a class="sourceLine" id="cb18-5" title="5">n &lt;-<span class="dv">500</span> <span class="co"># number of replications in each simulation</span></a>
<a class="sourceLine" id="cb18-6" title="6">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sig<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>)))) <span class="co"># the critical value</span></a>
<a class="sourceLine" id="cb18-7" title="7"></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co"># store the power </span></a>
<a class="sourceLine" id="cb18-9" title="9">power_t&lt;-<span class="kw">numeric</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb18-10" title="10"></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="cf">for</span>(j <span class="cf">in</span> v){</a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13">reject.t&lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&#39;numeric&#39;</span>,<span class="dt">length=</span>m)</a>
<a class="sourceLine" id="cb18-14" title="14"></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb18-16" title="16">  rand_num&lt;-<span class="kw">rt</span>(n,<span class="dt">df=</span>j)</a>
<a class="sourceLine" id="cb18-17" title="17">  skew&lt;-<span class="kw">sk</span>(rand_num)</a>
<a class="sourceLine" id="cb18-18" title="18">  reject.t[i]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(skew)<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb18-19" title="19">}</a>
<a class="sourceLine" id="cb18-20" title="20">power_t[j]&lt;-<span class="kw">mean</span>(reject.t)</a>
<a class="sourceLine" id="cb18-21" title="21">}</a>
<a class="sourceLine" id="cb18-22" title="22"></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="kw">plot</span>(v,power_t,<span class="dt">xlab=</span><span class="st">&#39;df&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;power&#39;</span>,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&#39; power versus v for t(v)&#39;</span>)</a>
<a class="sourceLine" id="cb18-24" title="24"></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>from the power curve for t distribution, we can conclude that the power is very high when df is small, and it is decreasing as df increasing, this is because when the df is large, the limit distribution of t distribution is normal distribution, so that the power will be low if df is very large.</p>
</div>
<div id="a" class="section level2">
<h2>6A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : <span class="math inline">\(Î¼ = Î¼0\)</span> vs H1 : <span class="math inline">\(Î¼ \ne Î¼0\)</span>, where <span class="math inline">\(Î¼0\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">set.seed</span>(<span class="dv">548546</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3">alpha&lt;-<span class="fl">0.05</span> <span class="co"># significance level</span></a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6">n&lt;-<span class="dv">100</span> <span class="co"># number of replicates in each simulation</span></a>
<a class="sourceLine" id="cb19-7" title="7">m&lt;-<span class="dv">1000</span> <span class="co"># number of simulations</span></a>
<a class="sourceLine" id="cb19-8" title="8"></a>
<a class="sourceLine" id="cb19-9" title="9"></a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="co">##  the codes below is to calculate empirical Type I error rate for normal distribution</span></a>
<a class="sourceLine" id="cb19-12" title="12"></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co"># reject.norm&lt;-vector(&#39;numeric&#39;,m)</span></a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co"># for(i in 1:m){</span></a>
<a class="sourceLine" id="cb19-15" title="15"> <span class="co"># rand_num&lt;-rnorm(n,mean=1)</span></a>
<a class="sourceLine" id="cb19-16" title="16">  </a>
<a class="sourceLine" id="cb19-17" title="17">  <span class="co">#pvalue&lt;-t.test(rand_num, alternative = &#39;two.sided&#39;,mu=1, conf.level = 1-alpha)$p.value</span></a>
<a class="sourceLine" id="cb19-18" title="18">  <span class="co">#reject.norm[i]&lt;-ifelse(pvalue&lt;alpha,1,0)</span></a>
<a class="sourceLine" id="cb19-19" title="19"> <span class="co"># }</span></a>
<a class="sourceLine" id="cb19-20" title="20"></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="co">#t1e.norm&lt;-mean(reject.norm)</span></a>
<a class="sourceLine" id="cb19-22" title="22"> </a>
<a class="sourceLine" id="cb19-23" title="23"><span class="co">## </span></a>
<a class="sourceLine" id="cb19-24" title="24"></a>
<a class="sourceLine" id="cb19-25" title="25"></a>
<a class="sourceLine" id="cb19-26" title="26"><span class="co"># calculate empirical Type I error rate for chisq distribution</span></a>
<a class="sourceLine" id="cb19-27" title="27">reject.chisq&lt;-<span class="kw">vector</span>(<span class="st">&#39;numeric&#39;</span>,m)</a>
<a class="sourceLine" id="cb19-28" title="28"> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb19-29" title="29">  rand_num&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-30" title="30">  pvalue&lt;-<span class="kw">t.test</span>(rand_num, <span class="dt">alternative =</span> <span class="st">&#39;two.sided&#39;</span>,<span class="dt">mu=</span><span class="dv">1</span>, <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb19-31" title="31">  reject.chisq[i]&lt;-<span class="kw">ifelse</span>(pvalue<span class="op">&lt;</span>alpha,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-32" title="32"> } </a>
<a class="sourceLine" id="cb19-33" title="33"></a>
<a class="sourceLine" id="cb19-34" title="34">t1e.chisq&lt;-<span class="kw">mean</span>(reject.chisq)</a>
<a class="sourceLine" id="cb19-35" title="35"></a>
<a class="sourceLine" id="cb19-36" title="36"></a>
<a class="sourceLine" id="cb19-37" title="37"><span class="co"># empirical Type I error rate for uniform distribution</span></a>
<a class="sourceLine" id="cb19-38" title="38">reject.unif&lt;-<span class="kw">vector</span>(<span class="st">&#39;numeric&#39;</span>,m)</a>
<a class="sourceLine" id="cb19-39" title="39"> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb19-40" title="40">  rand_num&lt;-<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-41" title="41">  pvalue&lt;-<span class="kw">t.test</span>(rand_num, <span class="dt">alternative =</span> <span class="st">&#39;two.sided&#39;</span>,<span class="dt">mu=</span><span class="dv">1</span>, <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb19-42" title="42">  reject.unif[i]&lt;-<span class="kw">ifelse</span>(pvalue<span class="op">&lt;</span>alpha,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-43" title="43"> } </a>
<a class="sourceLine" id="cb19-44" title="44"></a>
<a class="sourceLine" id="cb19-45" title="45">t1e.unif&lt;-<span class="kw">mean</span>(reject.unif)</a>
<a class="sourceLine" id="cb19-46" title="46">               </a>
<a class="sourceLine" id="cb19-47" title="47"></a>
<a class="sourceLine" id="cb19-48" title="48"><span class="co"># calculate empirical Type I error rate for exponential distribution </span></a>
<a class="sourceLine" id="cb19-49" title="49">reject.exp&lt;-<span class="kw">vector</span>(<span class="st">&#39;numeric&#39;</span>,m)</a>
<a class="sourceLine" id="cb19-50" title="50"> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb19-51" title="51">  rand_num&lt;-<span class="kw">rexp</span>(n,<span class="dt">rate=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-52" title="52">  pvalue&lt;-<span class="kw">t.test</span>(rand_num, <span class="dt">alternative =</span> <span class="st">&#39;two.sided&#39;</span>,<span class="dt">mu=</span><span class="dv">1</span>, <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb19-53" title="53">  reject.exp[i]&lt;-<span class="kw">ifelse</span>(pvalue<span class="op">&lt;</span>alpha,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-54" title="54"> } </a>
<a class="sourceLine" id="cb19-55" title="55"></a>
<a class="sourceLine" id="cb19-56" title="56">t1e.exp&lt;-<span class="kw">mean</span>(reject.exp)</a>
<a class="sourceLine" id="cb19-57" title="57"></a>
<a class="sourceLine" id="cb19-58" title="58">t1e&lt;-<span class="kw">c</span>(t1e.chisq,t1e.unif,t1e.exp)</a>
<a class="sourceLine" id="cb19-59" title="59"><span class="kw">names</span>(t1e)&lt;-<span class="kw">c</span>(<span class="st">&#39;Ï‡2(1)&#39;</span>,<span class="st">&#39;U[0,2]&#39;</span>,<span class="st">&#39;E(1)&#39;</span>)</a>
<a class="sourceLine" id="cb19-60" title="60"><span class="kw">print</span>(t1e)</a></code></pre></div>
<pre><code>##  Ï‡2(1) U[0,2]   E(1) 
##  0.060  0.055  0.053</code></pre>
<p>from the result above, we know that the empirical Type I error rate for <span class="math inline">\(\chi^{2}(1)\)</span>, <span class="math inline">\(U[0,2]\)</span>, <span class="math inline">\(E(1)\)</span> distribution is 0.060,0.055,0.053, so for <span class="math inline">\(U[0,2]\)</span> and <span class="math inline">\(E(1)\)</span>, the empirical Type I error rate of the t-test is close to the nominal significance level <span class="math inline">\(\alpha =0.05\)</span>, and for <span class="math inline">\(\chi^{2}(1)\)</span>, the empirical Type I error rate is larger than 0.05.</p>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="section-1" class="section level2">
<h2>7.6</h2>
<ul>
<li>question: Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec})\)</span>,<span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana})\)</span>,<span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta})\)</span>,<span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span>.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">attach</span>(scor)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw">set.seed</span>(<span class="dv">1468</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># draw the scatterplot of each pair of test scores</span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="kw">pairs</span>(scor,<span class="dt">main=</span><span class="st">&#39;the scatter plots for each pair of test scores&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/9vb////tmb/25D/27b//7b//9v///97TW9PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQrElEQVR4nO2dDX/jtg2HmTTXXF+uXbJe99Im6cvabXG39bp4bbc4F/P7f6iKokiCAChQlG35Zvz7a2JLIAg8IimJ4inGqkZllg7g2KWABCkgQQpIkAISpIAEKSBBCkiQAhKkgAQpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBCkiQAhIEAW3/8RB/ytremhePaBNXdPvDS2M+bQ7Qrs3ZfVs4pSjGMiT7AKC3r88fws+miPiiG9Ppqsolq90AAlGMZUj3AUAr43b6n00R8UUrEyxqbnniZSxDus/88rpD+/G929fp/I/9z4euSRpz9umjd/3da3P+Jjj41+fGXLxJgH7pvr/358fg4MH+56Ou6CdvYpWdXHDRLvcIarIxlk4/d17e+9Jb/70zuYiUQAygiA8nd41i84hWJMMUcdhn01bj1ZXNAD1f95svHlyATkNjWSX7AZDf7T4O3ocNoZoQWrLLPYKaNtF3rOgqVpAOLYgBFAmAgGscWwaIZOgqgIBCveb9R/v00kUCu9jKHQW/uTN88cb+NwbX7fjZmMshos7GxxUcdBVfPjqLMOz4xg3tkMdQU+cwxtIl/rvHt9fOobdeJ4d5DKFIBJRc53WiLpbqhRGnLha3WvvrPz9ylUFA3d6rPjcf4E3skSv/xRn5iAaPK8+/+9HVefGjBfKhQTvoEdZkcSzrT360g/Vgh2IARSIgGCysMwcE6oURJ0Bhq/nGt6McULc3tt1skBwcuG19RGEgWvtO6rr2rSvnB5sEKLODHmFN2xgLPAF4a3dAaQykCHRdqhNnCCNOgMJW1w3/8us1ArQx44C6/Td9/SFut2HY+fa1L/lXmGBmBz2CmlxIQyzdx4CjCGiIARRBgEp1kgxBxOAsNmzte94zBtTxvckDrG5BzvW3H2UjpdCCbtLHEEttCyJFprSg1BdTxNlp3m91dmSQBuFgQNIYNAT3dfzMjUH0MIcjncWy+fh7FlCMARShgKQxKGYIIsbXQd3Wzu3b234M8j5CPmdf2u4sQuscOYv1lv35x7XPrAWVziiwpt5kiKXz8qlrnrFz5IBCDKAIA6hQJ84QRpzM4lYTB+lNfw2wgVcJiVgKLlwzkOugwcEPsW9nLTC7DgIeU01+WPSxhIou+RYEYigP0qU6SYYgYr+vNxu2urPYxffrcGl58cb/tG+/6Yb5/nIYt9p/f+N3ZFfSX/Tt0Rd118Dm4zcpSl8+2eVZpJq2KZbhSvoLy49BIQZQhAPE10kyBBEP+2zaOnG6o/pObY86bAwKSJACEqSABOmUqyAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCC9gpoG58j38jGo3r+7IH4WfulFzvwPqa9Alq7J8I3z7+/f/pw3nOI52u33oD66b7vwPuo9t7F1ldPrx63d7MWqm6/+qlrQYyf1Q23dafaN6Cub2wu+0zmurHUTweH2bpb7RlQ1wF2kgIPaOWWe77TgJ4+uLc76QTPXBfrR+53uov50XMXw6hjQfy4HrYT72PaK6DVzk7E3Gm+7107uYgYk14oClJAghSQIAUkSAEJUkCCFJAgBSToAIAMrCj7Mt2Pib/gx33qRAFt8n8uIdS6Zx0hoO1tf3fS38xV1LpnHSGg/tYu/hJr3bOOEFBoQRXTAKcJaPgnq/sdg0xJVUZmL0YjVtS2Ms3pRYSSZtSoD7L735SNTL/b/zdW3ZAwX18Gw5DSTy/P/nZd9W8+DgdoQDMcSSb3IadkYogR3MS3oPg74GObzvYr97jIPv9hn2exiYAAHdJ7hp+kOyCjvGAJUHYghtaIAXWnr34Sd69nsWmAUO4cIIowN8q6XWFcMcPADWvCDdbGFrTf66BJgHDjYAFhcYCyfsMAyjETp8FuY45sDBJyZ20Mosjsp4Asi6Xl9CWk2V6SAuJykgGRs1gVINZsIUB33xpztQnvtnDNtft1dk8A0U5RBYgbgxoB0dP8hDTbS966Nx9c9tfrq6thJYfdvGAAMeFWtCB2kBZy5xGmcg1pTi8SSt7dW/fQtzsd9NcUnz34WxsKiDvoIiAcHD7H5ZbJimOzVBdLgNxrHs7u/VmTXJcw42YbIP5MNwbIskbT0mwvCQD5Cy6+BeGeEbbiGHJ+PCDSQiwGRI/FMQByY9DGvUzopoNEAZFLaA6QIRgFihFAVh9tYNRoWprtJQGg/vRlS2cxmpTce0hwhS42Dij072UG6ZrtTOOgVrWAjCHjGdPF6N6lWlDNdkPusDhA2MiygBIi6KsG0HFfSefpW7YFxXRyK0wRJW9HAdnoyNBgD/FUYwIgA7JjrNIogcYKQjHvZQM1i60yyoYMefZATzVMSVVGZi9GI1aZ7XE91ThCHddTjWPUIZ5qnIgUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJCgU7lZbU+zoQhfJx9wTb0FT+NGybDgdthjDLO6Y4LmlzRxboo+EpwOKDvqo4A4I/AFHK5lp1zDdFShydfUmx12MMFW08yK9S3YxfKSeDp5Xgsqp1VlhOf/i+NBvWaVNKyq3PO5I0eckWEe0+ZWYlBT05xcJMXPRdIOiDgiRjUHRD5q07KdUZKPpBkQdYSMwvYxQMz+xQAVAkGA3JOD7d09XEGE6+UBkdN81fqg0pVQe5rtJZkoGEDu6XQHCa4gwmtACuvmyPm/BhBrcDSADHcWW3dorrIVRLheww2txKiY/HhQ6flhY5qyCX4KyZMxIRAM6OnV/+7yFUQkdwYQNSodkZpbjb0CKj2F5COhgLZ33716zFYQ4XpnACL1IS7xt0yiILlk6SkkHy5zobju/x4WWEGEl1mhdKInMgZxPWi0BYVH1AdpQfgpJDmtcB7dl/4dOXAFEbYymTNweqen+XywHqLIg8puDQPAvY5BhaeQCBDvsfY6CLgqAwrXyRIg0BztIQCRInkjtmiNRSMgOF0yCiibOigAinMd9hCAuhZ0afkxKPyGg2ADoNQ9c2fkajLlHrsbqS9ATmZjcYiqG4M25w8UUKFwUwvKPpcBcWZ8fWhk3vtZ7PmznxRQQf4Vas+fk7NYSVVGzGl+B0bLzEk/vXTn+c3yf1hsEbWjPREpIEEKSJACEqSABCkgQQpIkAISpIAEKSBBM25S9F5sUkkTpu9G7+ZNmOcq36gXdvAzBzVPck0+BzlRuwJkUiAj7oc5LLMjQEwLIgZxMrtROypZbPLIyHJWTYDG60vt2Sz3ZBVMa8JoC4DQkDAX0PgBAS117lA0BxChMwIIm80EVGiLCdBIddM0D5A/SPCRDRcwPZSl3NHDtyKgYqvgjllj0+HqnVayJGREDiexmgCIsiaAiitg2jjNakFsCCRg5pkxzd09nfSPpZ+vzcXn9yQ46oQHxIZ0RC2IjkGyVfe5f+Xahw/Du4g2ZxygQoWoxbKP55e5DiocTbnJ48vJ4bNfP+SeMoW/RYMA8axrrqSXGaSrABlm0MBW/eeVMecO0LBkjwTXCiguYmhNs71krD/PXWxBpF7Xxa5vhi420oL4IyK3ILC9Ic3pRYqxWMsBYvlgQG7wefrgfnQMKqxIGgGUWg5O8yDv7qgFlI+cTL3u89qYi9c3w1nsfbYFgXYAnRW6tIW14TQP8+6OqiPqo6ZtfPRKOlwOESPYNtjGEfbi+1hU/UHe3RGixB6YS38ULbbK9ri/rBmafmaUrZEBO7kuNjS4QhUHencHOpC8x3TcWXJCDHgMStWVeo+Ju/LIcBUHeSO55S8v6CBtyQFtBES8MPXxYeEeXq9TAYS+F1bNCTFMEzNE06NUNDJ7Maqdky6tmuPSnAzm/0GlVXOMThNQadUco9MENGHV3IkCqpcCEqSABCkgQQpIkAISpIAEKSBBCkhQywSAoDrbvRgd2QIqE35mgbATZtYiu9J0R2YyeU4kTTMeCyAmkNJ8UG5WyL2c1iRAu1j3ItU7UiQlKbbmCGjMymDPM1uQFNS0bOeUNMy6hCpA/IxildF4BvzBWAgQL/KUgW8+TO40pRZApbCa02woklhweMhTBhK1ZQExKTUAKml6mlK9csnCk0MGkGBlGHdkmt/ENUSvvna/hm8MIAn1xDTbS9JWRD3ygKwMyGBXJq4hetm/BmT4JrYgS1BPTLOhSEmMx8IBZQGNu/Kfh3cQDY9E+7l3cQxqTDOrt61kPEQjgJgxiFhRQExw7nNYQ+QB9d84QHSpxLKARlvQAAguzCBWBrorpWXAGiL3a/h2jIBoIy4edm4MolaVgMAaosDJvXhndAyakWZ9ycJioxIk4cKNqdeY3IwNzsA1RO5//20cUFzCsE9Ala/osuUVZpbJHuVuagBVZFA6YPsERBYbMUcJRrQsoGwMsgcBVHxFV/yHB2EQbm9Bhh1Z57Wg2HXr0qxyz6v0iq5wiCy44yIBJ8s8eTIGpRXffHC1LcjDDtGZA4xBtAjoW8AL/J+4j62Iqxcc6PxmtwlQOFzZrkWug0qqMjJ7MTqqm9UTUcVZ7NofA33BUknuvvl0VdPF/AuOT1Q6BglSQIIUkCAFJEgBCVJAghSQIAUkSG9WpTRnlQyzGCm0wnRHNm1mUcRogiMlNTrdwRkV02nnNAuQSRNliU4J0EjjsLxVFSC6mqQQbKPmlAQTyflcJ+Oe2PExVFFEhjXpLNOCwnx0akR8C0IADe6IPCDLtKCYIjuFPZLOYi3IjqfOTNoLgIBDapSmUd8NQGSxSc1TjTFAkhGcu34XuhjThLDHYQPKvABIMjLp6YcMKH9MtVQL4kbV5jGIWuRGtLYJgJZoQdnh5lMPoyrNiQJi8saADOnU3HXQxpjzh/4v4oVFaAu1oOoleNSOAYQzx8Hlq2hGALln5OvLfoVMWIR2TIDYRZzEkgdE3NAxqAaQf8YAF6Et38VguBWArAjIMoB4RLSLdR3r7D5bhLZUC2KiJYC4dobrZcYgFlDpkNB0Ni8e4SI02oKWecFSygy658/LJvdE/REjvgXR+txDKg8oLkIjaR7mBUuFYAkgPPpyuSMjJrjC4WAuK3y/2t6eP4RFaCTNA71gKSRs4kqPCkCWAZSfnywPiOmqPKDRYL0O84KlwkUiCRhw5BfsIECFNTKgEVloVwcIfT/IC5bQMS82+aytcfUaY6ARHxwZzeIFeE06GH29dj1IoyCKRuLw0mR0dFOu5Z/TnRnuV6MjAz/hM91kh7NKvpuAJqx5Ok1AE9Y8nSig+jVPpwpoisNZJRWQUFIBnboUkCAFJEgBCVJAghSQIAUkSAEJagW0Cc8svdbGvcAabaySe4c9Ldrkr59ixmXaI/NqBNTdDcMJ3adXj9vbG7SxTutLS4s2+Xu+Pn/Agc2JzKsRkKv3Ls0YrK+YjfVaX6Gi/us0f9uv3PuzcZkWT5kaAW26ZrtKjXb1J/eOeLSxWl3XwEWfXp7dT/bnuhgp0+QJaEeAXjx2XxvDcJNXqOjmhesYuwDU5gloN13MVU76Sa0r9+yT6bKby6n+npku1uYJaDeDtD9CTUOhL4H9uRZ5NdWfA4TLtHkC2t1p/qrtZLpyk+dXuOhqZ6f5Jk9AeqEoSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCVJAghSQIAUkSAEJUkCCFJAgBSRIAQlSQIIUkCAFJEgBCfoNgIEvfPVjJG8AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co"># calculate the sample correlation matrix</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co"># calculate the bootstrap estimates of the standard error</span></a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3">stat&lt;-<span class="cf">function</span>(data,ind){</a>
<a class="sourceLine" id="cb24-4" title="4">  </a>
<a class="sourceLine" id="cb24-5" title="5">  cor12&lt;-<span class="kw">cor</span>(data[ind,<span class="dv">1</span>],data[ind,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb24-6" title="6">  cor34&lt;-<span class="kw">cor</span>(data[ind,<span class="dv">3</span>],data[ind,<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb24-7" title="7">  cor35&lt;-<span class="kw">cor</span>(data[ind,<span class="dv">3</span>],data[ind,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb24-8" title="8">  cor45&lt;-<span class="kw">cor</span>(data[ind,<span class="dv">4</span>],data[ind,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb24-9" title="9">  </a>
<a class="sourceLine" id="cb24-10" title="10">  </a>
<a class="sourceLine" id="cb24-11" title="11">  <span class="kw">return</span>(<span class="kw">c</span>(cor12,cor34,cor35,cor45))</a>
<a class="sourceLine" id="cb24-12" title="12">}</a>
<a class="sourceLine" id="cb24-13" title="13"></a>
<a class="sourceLine" id="cb24-14" title="14">Boot&lt;-<span class="kw">boot</span>(scor,stat,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb24-15" title="15"></a>
<a class="sourceLine" id="cb24-16" title="16">sd.boot&lt;-<span class="kw">apply</span>(Boot<span class="op">$</span>t,<span class="dv">2</span>,sd)</a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18">sd.boot</a></code></pre></div>
<pre><code>## [1] 0.07712548 0.04758565 0.06063961 0.06671023</code></pre>
<p>from the scatterplot of each pair of test scores, we can know that the scores of each subject are positively correlated, the most relevant scores are algebra and analysis, the correspond trend of positive correlation in scatterplot is obvious and steep, the least relevent scores are mechanics and stastics, the correspond trend of positive correlation in scatterplot is not obvious, and the standard error of correalation coefficients are 0.0771,0.0476,0.0606,0.0667.</p>
</div>
<div id="project-7.b" class="section level2">
<h2>project 7.B</h2>
<ul>
<li>question:Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).we can calculate that the skewness of <span class="math inline">\(\chi^{2}(5)\)</span> is <span class="math inline">\(\sqrt\frac{8}{5}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1468</span>)</a>
<a class="sourceLine" id="cb26-3" title="3">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,ind) {</a>
<a class="sourceLine" id="cb26-4" title="4">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[ind])</a>
<a class="sourceLine" id="cb26-5" title="5">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[ind] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-6" title="6">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[ind] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-7" title="7"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb26-8" title="8">}</a>
<a class="sourceLine" id="cb26-9" title="9">m&lt;-<span class="dv">500</span></a>
<a class="sourceLine" id="cb26-10" title="10">n&lt;-<span class="dv">200</span></a>
<a class="sourceLine" id="cb26-11" title="11">ci.n.norm&lt;-ci.n.basic&lt;-ci.n.perc&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb26-13" title="13">  data&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb26-14" title="14">  boot.skew&lt;-<span class="kw">boot</span>(data,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb26-15" title="15">  ci.n&lt;-<span class="kw">boot.ci</span>(boot.skew,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;perc&#39;</span>))</a>
<a class="sourceLine" id="cb26-16" title="16">  ci.n.norm[i,]&lt;-<span class="st"> </span>ci.n<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb26-17" title="17">  ci.n.basic[i,]&lt;-<span class="st"> </span>ci.n<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb26-18" title="18">  ci.n.perc[i,]&lt;-<span class="st"> </span>ci.n<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb26-19" title="19">}</a>
<a class="sourceLine" id="cb26-20" title="20"> </a>
<a class="sourceLine" id="cb26-21" title="21">ci.chisq.norm&lt;-ci.chisq.basic&lt;-ci.chisq.perc&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-22" title="22"></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb26-24" title="24">  data&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb26-25" title="25">  boot.skew&lt;-<span class="kw">boot</span>(data,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb26-26" title="26">  ci.chisq&lt;-<span class="kw">boot.ci</span>(boot.skew,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;perc&#39;</span>))</a>
<a class="sourceLine" id="cb26-27" title="27">  ci.chisq.norm[i,]&lt;-<span class="st"> </span>ci.chisq<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb26-28" title="28">  ci.chisq.basic[i,]&lt;-<span class="st"> </span>ci.chisq<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb26-29" title="29">  ci.chisq.perc[i,]&lt;-<span class="st"> </span>ci.chisq<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb26-30" title="30">}</a>
<a class="sourceLine" id="cb26-31" title="31"></a>
<a class="sourceLine" id="cb26-32" title="32"><span class="kw">cat</span>(<span class="st">&#39;for normal distribution the coverage rate:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb26-33" title="33">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>(ci.n.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.n.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb26-34" title="34">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.n.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.n.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb26-35" title="35">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>(ci.n.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.n.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb26-36" title="36">    )</a></code></pre></div>
<pre><code>## for normal distribution the coverage rate:
##  norm= 0.93 basic= 0.932 perc= 0.938</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;for normal distribution missing left:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb28-2" title="2">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>(ci.n.norm[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span> ),</a>
<a class="sourceLine" id="cb28-3" title="3">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.n.basic[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb28-4" title="4">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>(ci.n.perc[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-5" title="5">    )</a></code></pre></div>
<pre><code>## for normal distribution missing left:
##  norm= 0.028 basic= 0.028 perc= 0.026</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;for normal distribution missing right:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb30-2" title="2">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>( ci.n.norm[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb30-3" title="3">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.n.basic[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb30-4" title="4">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>(ci.n.perc[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-5" title="5">    )</a></code></pre></div>
<pre><code>## for normal distribution missing right:
##  norm= 0.042 basic= 0.04 perc= 0.036</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;for Chi-square distribution the coverage rate:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb32-2" title="2">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>(ci.chisq.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span>ci.chisq.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb32-3" title="3">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.chisq.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span>ci.chisq.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb32-4" title="4">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>(ci.chisq.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span>ci.chisq.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb32-5" title="5">    )</a></code></pre></div>
<pre><code>## for Chi-square distribution the coverage rate:
##  norm= 0.81 basic= 0.794 perc= 0.808</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;for Chi-square distribution missing left:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb34-2" title="2">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>(ci.chisq.norm[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) ),</a>
<a class="sourceLine" id="cb34-3" title="3">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.chisq.basic[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb34-4" title="4">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>(ci.chisq.perc[,<span class="dv">1</span>]<span class="op">&gt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb34-5" title="5">    )</a></code></pre></div>
<pre><code>## for Chi-square distribution missing left:
##  norm= 0.02 basic= 0.034 perc= 0.006</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;for Chi-square distribution missing right:</span><span class="ch">\n</span><span class="st">&#39;</span>,</a>
<a class="sourceLine" id="cb36-2" title="2">    <span class="st">&#39;norm=&#39;</span>,<span class="kw">mean</span>(ci.chisq.norm[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb36-3" title="3">    <span class="st">&#39;basic=&#39;</span>,<span class="kw">mean</span>(ci.chisq.basic[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)),</a>
<a class="sourceLine" id="cb36-4" title="4">    <span class="st">&#39;perc=&#39;</span>,<span class="kw">mean</span>( ci.chisq.perc[,<span class="dv">2</span>]<span class="op">&lt;</span><span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb36-5" title="5">    )</a></code></pre></div>
<pre><code>## for Chi-square distribution missing right:
##  norm= 0.17 basic= 0.172 perc= 0.186</code></pre>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="section-2" class="section level2">
<h2>7.8</h2>
<ul>
<li><p>question: Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{theta}\)</span>.</p></li>
<li><p>solution: we calcualte the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{theta}\)</span> following the standard steps, which means:</p></li>
</ul>
<p><span class="math display">\[bisa_{jack}=(n-1)(\bar{\hat\theta}_{(\cdot)}-\hat\theta)\]</span></p>
<p><span class="math display">\[ sd_{jack}(\hat\theta) = \sqrt{\frac{n-1}n\sum_{i=1}^n(\hat\theta_{(i)}-\bar{\hat\theta}_{(\cdot)})^2}\]</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">attach</span>(scor)</a></code></pre></div>
<pre><code>## The following objects are masked from scor (pos = 3):
## 
##     alg, ana, mec, sta, vec</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">len&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb40-2" title="2"></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co"># theta.dot.hat stores the estimators without one observation</span></a>
<a class="sourceLine" id="cb40-4" title="4">theta.dot.hat&lt;-<span class="kw">vector</span>(<span class="dt">length =</span> len)</a>
<a class="sourceLine" id="cb40-5" title="5"></a>
<a class="sourceLine" id="cb40-6" title="6">C&lt;-<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb40-7" title="7">eigen.value&lt;-<span class="kw">eigen</span>(C,<span class="dt">only.values =</span> T)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb40-8" title="8"></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="co"># theta.hat is the estimator with all observations</span></a>
<a class="sourceLine" id="cb40-10" title="10">theta.hat&lt;-<span class="kw">max</span>(eigen.value)<span class="op">/</span><span class="kw">sum</span>(eigen.value)</a>
<a class="sourceLine" id="cb40-11" title="11"></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>len){</a>
<a class="sourceLine" id="cb40-13" title="13">  C&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb40-14" title="14">  eigen.value&lt;-<span class="kw">eigen</span>(C,<span class="dt">only.values =</span> T)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb40-15" title="15">  theta.dot.hat[i]&lt;-<span class="kw">max</span>(eigen.value)<span class="op">/</span><span class="kw">sum</span>(eigen.value)</a>
<a class="sourceLine" id="cb40-16" title="16">}</a>
<a class="sourceLine" id="cb40-17" title="17"></a>
<a class="sourceLine" id="cb40-18" title="18"><span class="co"># calculate the bias</span></a>
<a class="sourceLine" id="cb40-19" title="19">bias&lt;-(len<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.dot.hat)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb40-20" title="20"></a>
<a class="sourceLine" id="cb40-21" title="21"><span class="co"># calculate the sd</span></a>
<a class="sourceLine" id="cb40-22" title="22">standard_dev&lt;-<span class="kw">sqrt</span>((len<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.dot.hat<span class="op">-</span><span class="kw">mean</span>(theta.dot.hat))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb40-23" title="23"></a>
<a class="sourceLine" id="cb40-24" title="24"><span class="kw">print</span>(<span class="kw">c</span>(bias,standard_dev))</a></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>7.10</h2>
<ul>
<li>question: In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## è½½å…¥éœ€è¦çš„ç¨‹è¾‘åŒ…ï¼šlattice</code></pre>
<pre><code>## 
## è½½å…¥ç¨‹è¾‘åŒ…ï¼š&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb46-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb46-6" title="6">y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb46-7" title="7">x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb46-8" title="8"></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="co"># linear model</span></a>
<a class="sourceLine" id="cb46-10" title="10">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb46-11" title="11">yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb46-12" title="12">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb46-13" title="13"></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="kw">summary</span>(J1)</a>
<a class="sourceLine" id="cb46-15" title="15"><span class="co"># quadratic</span></a>
<a class="sourceLine" id="cb46-16" title="16"></a>
<a class="sourceLine" id="cb46-17" title="17">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb46-18" title="18">yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb46-19" title="19">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb46-20" title="20">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb46-21" title="21"><span class="kw">summary</span>(J2)</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23"><span class="co"># exponential</span></a>
<a class="sourceLine" id="cb46-24" title="24">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb46-25" title="25">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb46-26" title="26">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb46-27" title="27">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb46-28" title="28"><span class="kw">summary</span>(J3)</a>
<a class="sourceLine" id="cb46-29" title="29"></a>
<a class="sourceLine" id="cb46-30" title="30"><span class="co"># cubic polinomial</span></a>
<a class="sourceLine" id="cb46-31" title="31">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb46-32" title="32">yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb46-33" title="33">          <span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb46-34" title="34">e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb46-35" title="35">}</a>
<a class="sourceLine" id="cb46-36" title="36"></a>
<a class="sourceLine" id="cb46-37" title="37">e&lt;-<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb46-38" title="38"><span class="kw">names</span>(e)&lt;-<span class="kw">c</span>(<span class="st">&#39;linear model&#39;</span>,<span class="st">&#39;quadratic&#39;</span>,<span class="st">&#39;exponential&#39;</span>,<span class="st">&#39;cubic polinomial&#39;</span>)</a>
<a class="sourceLine" id="cb46-39" title="39"><span class="kw">print</span>(e)</a></code></pre></div>
<pre><code>##     linear model        quadratic      exponential cubic polinomial 
##         19.55644         17.85248         18.44188        634.22530</code></pre>
<p>from the above result we know that quadratic model is selected by the cross validation procedure, however when we use function <strong>sumary</strong> we can get the adjusted <span class="math inline">\(R^2\)</span> for each model:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">summary</span>(J4)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4347 -2.0627 -0.3247  2.2127 13.1177 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.763718  26.402670  -0.105    0.917
## x            2.908468   3.938834   0.738    0.464
## I(x^2)      -0.160916   0.189976  -0.847    0.401
## I(x^3)       0.003424   0.002968   1.154    0.254
## 
## Residual standard error: 3.902 on 48 degrees of freedom
## Multiple R-squared:  0.6176, Adjusted R-squared:  0.5937 
## F-statistic: 25.84 on 3 and 48 DF,  p-value: 4.264e-10</code></pre>
<p>the adjusted <span class="math inline">\(R^2\)</span> for linear model, quadratic model, exponential model, cubic model is 0.5319, 0.591, 0.5283, 0.5937, the maximum one is cubic polynomial model, so that the cubic polynomial model is supposed to be chosen by adjusted <span class="math inline">\(R^2\)</span>.</p>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="section-4" class="section level2">
<h2>8.3</h2>
<ul>
<li><p>question: The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p></li>
<li><p>solution: we use function <strong>maxout</strong> to calculate maximum number of extreme points in each (x,y) pair, if the null hypothesis is right, which means the variances of the two populations are same, then, after permuting z = c(x,y), we designate first n1 elements to be x, the left n2 elements to be y, $ n1 n2$, we get a replicate, their variances also should be equal, we calculate maximum number of extreme points using this replicate. Repeating this procedure many times, we can calculate p value, meanwhile, by repeating the experiments many times, we can calculating type I error rate and the power.</p></li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1468</span>)</a>
<a class="sourceLine" id="cb50-3" title="3"></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="co"># calculate maximum number of extreme points for pair x,y</span></a>
<a class="sourceLine" id="cb50-5" title="5">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb50-6" title="6">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-7" title="7">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb50-8" title="8">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb50-9" title="9">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb50-10" title="10"><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb50-11" title="11">}</a>
<a class="sourceLine" id="cb50-12" title="12"></a>
<a class="sourceLine" id="cb50-13" title="13"><span class="co"># the statistics passed to boot</span></a>
<a class="sourceLine" id="cb50-14" title="14">stat&lt;-<span class="cf">function</span>(z,ix,n){</a>
<a class="sourceLine" id="cb50-15" title="15">  x&lt;-z[ix][<span class="dv">1</span><span class="op">:</span>n]</a>
<a class="sourceLine" id="cb50-16" title="16">  y&lt;-z[ix][<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>n)]</a>
<a class="sourceLine" id="cb50-17" title="17">  <span class="kw">maxout</span>(x,y)</a>
<a class="sourceLine" id="cb50-18" title="18">}</a>
<a class="sourceLine" id="cb50-19" title="19"></a>
<a class="sourceLine" id="cb50-20" title="20"><span class="co"># this function is used to calculate p value</span></a>
<a class="sourceLine" id="cb50-21" title="21">permu_count5&lt;-<span class="cf">function</span>(n1,n2,<span class="dt">mu=</span><span class="dv">0</span>,sd1,sd2){</a>
<a class="sourceLine" id="cb50-22" title="22">  x&lt;-<span class="kw">rnorm</span>(n1,mu,sd1)</a>
<a class="sourceLine" id="cb50-23" title="23">  y&lt;-<span class="kw">rnorm</span>(n2,mu,sd2)</a>
<a class="sourceLine" id="cb50-24" title="24">  z&lt;-<span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb50-25" title="25">  R=<span class="dv">999</span></a>
<a class="sourceLine" id="cb50-26" title="26">  boot_obj&lt;-<span class="kw">boot</span>(z,<span class="dt">statistic =</span> stat,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&#39;permutation&#39;</span>,<span class="dt">n=</span>n1)</a>
<a class="sourceLine" id="cb50-27" title="27">  count&lt;-<span class="kw">c</span>( boot_obj<span class="op">$</span>t0, boot_obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb50-28" title="28">  </a>
<a class="sourceLine" id="cb50-29" title="29">  p.value&lt;-<span class="kw">mean</span>(count<span class="op">&gt;=</span>count[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb50-30" title="30">  <span class="kw">return</span>(p.value)</a>
<a class="sourceLine" id="cb50-31" title="31">}</a>
<a class="sourceLine" id="cb50-32" title="32">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb50-33" title="33">p_value&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb50-34" title="34"></a>
<a class="sourceLine" id="cb50-35" title="35"><span class="co"># calculate the empirical type I error rate</span></a>
<a class="sourceLine" id="cb50-36" title="36"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) p_value[i]&lt;-<span class="kw">permu_count5</span>(<span class="dt">n1=</span><span class="dv">20</span>,<span class="dt">n2=</span><span class="dv">30</span>,<span class="dt">sd1=</span><span class="dv">1</span>,<span class="dt">sd2=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb50-37" title="37"><span class="kw">cat</span>(<span class="st">&#39;the empirical type I error rate is:&#39;</span>,<span class="kw">mean</span>(p_value<span class="op">&lt;</span><span class="fl">0.05</span>),<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</a></code></pre></div>
<pre><code>## the empirical type I error rate is: 0.043</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># calculate the power</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) p_value[i]&lt;-<span class="kw">permu_count5</span>(<span class="dt">n1=</span><span class="dv">20</span>,<span class="dt">n2=</span><span class="dv">30</span>,<span class="dt">sd1=</span><span class="dv">1</span>,<span class="dt">sd2=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="kw">cat</span>(<span class="st">&#39;the empirical power is:&#39;</span>,<span class="kw">mean</span>(p_value<span class="op">&lt;</span><span class="fl">0.05</span>))</a></code></pre></div>
<pre><code>## the empirical power is: 0.809</code></pre>
</div>
<div id="test-for-independence" class="section level2">
<h2>Test for independence</h2>
<ul>
<li>solution: we need to test the independence between X, Y1 for model1 and X, Y2 for model2, to solve this problem, we use function <strong>dcov.test</strong> in package <strong>energy</strong> to make a distance correlation test and we use function <strong>bcov.test</strong> in package <strong>ball</strong> to make a ball test, for convinience, we denote the power of <strong>dcov.test</strong> for model1 and model2 by power.dcov1, power.dcov2 respectively, similarly we denote the power of <strong>bcov.test</strong> by power.ball1, power.ball2, We calculate the power of two tests with respect to number of samples for model1 and model2 and draw the the power function image.</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb54-3" title="3"><span class="kw">library</span>(mixtools)</a>
<a class="sourceLine" id="cb54-4" title="4"></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co"># m is the number of experiments of each sample size n</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co"># R is the number of permutation replicates for calculating p value</span></a>
<a class="sourceLine" id="cb54-8" title="8">power.contrast&lt;-<span class="cf">function</span>(m,n,R){</a>
<a class="sourceLine" id="cb54-9" title="9">  </a>
<a class="sourceLine" id="cb54-10" title="10">  pvalue.ball1&lt;-pvalue.dcov1&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb54-11" title="11">  pvalue.ball2&lt;-pvalue.dcov2&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb54-12" title="12"> </a>
<a class="sourceLine" id="cb54-13" title="13">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb54-14" title="14">  </a>
<a class="sourceLine" id="cb54-15" title="15">  <span class="co"># generate samples</span></a>
<a class="sourceLine" id="cb54-16" title="16">  X&lt;-<span class="kw">rmvnorm</span>(<span class="dt">n=</span>n,<span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb54-17" title="17">  e&lt;-<span class="kw">rmvnorm</span>(<span class="dt">n=</span>n,<span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">sigma=</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb54-18" title="18">  Y1&lt;-X<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e </a>
<a class="sourceLine" id="cb54-19" title="19">  Y2&lt;-X<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e </a>
<a class="sourceLine" id="cb54-20" title="20">  </a>
<a class="sourceLine" id="cb54-21" title="21">     seed&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb54-22" title="22">     <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb54-23" title="23">     pvalue.dcov1[i]&lt;-<span class="kw">dcov.test</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y1,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb54-24" title="24">     pvalue.ball1[i]&lt;-<span class="kw">bcov.test</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y1,<span class="dt">R=</span>R,<span class="dt">seed=</span>seed)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb54-25" title="25">     pvalue.dcov2[i]&lt;-<span class="kw">dcov.test</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y2,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb54-26" title="26">     pvalue.ball2[i]&lt;-<span class="kw">bcov.test</span>(<span class="dt">x=</span>X,<span class="dt">y=</span>Y2,<span class="dt">R=</span>R,<span class="dt">seed=</span>seed)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb54-27" title="27">  }</a>
<a class="sourceLine" id="cb54-28" title="28">  power.dcov1&lt;-<span class="kw">mean</span>(pvalue.dcov1<span class="op">&lt;</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb54-29" title="29">  power.ball1&lt;-<span class="kw">mean</span>(pvalue.ball1<span class="op">&lt;</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb54-30" title="30">  power.dcov2&lt;-<span class="kw">mean</span>(pvalue.dcov2<span class="op">&lt;</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb54-31" title="31">  power.ball2&lt;-<span class="kw">mean</span>(pvalue.ball2<span class="op">&lt;</span><span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb54-32" title="32">  </a>
<a class="sourceLine" id="cb54-33" title="33">  <span class="kw">return</span>(<span class="kw">c</span>(power.dcov1,power.ball1,power.dcov2,power.ball2))</a>
<a class="sourceLine" id="cb54-34" title="34">  </a>
<a class="sourceLine" id="cb54-35" title="35">}</a>
<a class="sourceLine" id="cb54-36" title="36"></a>
<a class="sourceLine" id="cb54-37" title="37"></a>
<a class="sourceLine" id="cb54-38" title="38">n&lt;-<span class="kw">seq</span>(<span class="dv">50</span>,<span class="dv">200</span>,<span class="dt">by=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-39" title="39">power&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">length</span>(n),<span class="dt">ncol=</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb54-40" title="40"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) power[i,]&lt;-<span class="kw">power.contrast</span>(<span class="dt">m=</span><span class="dv">200</span>,<span class="dt">n=</span>n[i],<span class="dt">R=</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb54-41" title="41"><span class="kw">plot</span>(n,power[,<span class="dv">1</span>],<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">pch=</span><span class="dv">0</span>,<span class="dt">main=</span><span class="st">&#39;power for model1&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;power&#39;</span>)</a>
<a class="sourceLine" id="cb54-42" title="42"><span class="kw">lines</span>(n,power[,<span class="dv">2</span>],<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb54-43" title="43"><span class="kw">points</span>(n,power[,<span class="dv">2</span>],<span class="dt">pch=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb54-44" title="44"><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;dcov&#39;</span>,<span class="st">&#39;ball&#39;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrY6AAA6ADo6AGY6OgA6Ojo6ZmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZmZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQtpCQttuQ27aQ2/+2ZgC2Zjq2kDq225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb29vb////tmb/25D/27b//7b//9v///8y4JG1AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKoUlEQVR4nO2d6YKjuBWFVd1VYyeTpO2ZrO2aLMVk6aSZdMo9Vbz/k0Uriw0cSQgQrnN+2Biu7hWftbEJUVGjEmtnIHcREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREFCGgF5/3AvxYZKLQrz73Pb4KB6e7Qa74K0MAZ2F1GGSiwFArz+KWwBUiruniS76AX35XuQBSGbvn78V4v6T/vVFLr7/w7Mr3oUQJ11KTvoPvfugMiyZ/OV78e6TSS2lENUJO5tfjmL35Vtx97H6aS/un7ohTP28/6sBVPs3gEr5a58JICNdEEqzLPN1Vivk/qnqo/ZALUrdf3ZGJu8OUJOws9mmEuJb9aELSstSojCSGxr/DtD9vx5zAST/7f8Ksauqr3v75x3U4kl9yNUyxzsF6ZP6fdC7+PCp+p9JbqpYK2FnsyEsnYuPdmvbUpbM3bMqORJQ498A+unD82s2gE6VbQhsa6C+NJVS/7uKldxT1RKXyqA0KYwMoFbCzmaZTO6j+TR025ZmWW7VBdT5r7lkA8iW/Lsnl6PSVJqH50J8c7x7Kg2kuiZ22mX94yJhs1m1Qe6zVTzqcDuXg5b/TAGphtjsiG2UZSP0t6P4+CgOqr0+izFAnYSjgNqWblnloOU/U0BXJUhm/9d7VXy+ObomySphCdLLtgQ5//kB6m2DTAdlik6rjChdA7pog0YAjbRBzn+GgPp6MTNG3ul+yIyI5GDm56PZfgWo24uNAbruxQrbizn/GQJyY5HOIEX38Sc9VlH/rR2nqH3vAdQdB40B6oRoxW785wfo3X9+EOI3rZH0H/WizJ/BYVqHn3/YW6s+QK2EAFAnxN/34v1HU9Nq/xkC+oytNiICAiIgIAICyvB8UF4iICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAkoMSGxGawFK667x6/aqd/9Ez2YxvvLmALlP0RenWXm1NLSSgPICFF61QwO4z40CmsvdhV8CAn4JCPgloGG/7OYX9ktAqRwS0LKRCWhZd/P5vTlAbcc9QYLjzgSoEGKnH00/DRjEATrDqRY2Aqh8eJaM9ONaA3NrXLjzPES7FUCvjwe3M+XAc2mXgPyi3Aqgl6OadcM88j3wPE84IDWjxp/tc4j6SU31YKt6JlrV4prcNgD5lqDh85zXla2QpPWkHqV+EPogf5zkt2zpFKzChek99orcjbAEcW2QRuXhDpYgU1CKuyfXqhnP8l8o9WO5h14HV+7C+4ZMejEIyFbYuydDyhGTn6o+N23TVgCFuoOAyhrQLwwLA0jRKXZNDbtdQKibHy5BctO/j3VB3Ryg0q8XgzI8yp42SJai3zVBNgfo0kv0SXvVedW9mOq6bC9WVaY76M3m9gBNcDcwDtILTVfwhgHF+M0XkJtDbfC5+IVOd1yGyQVQ6eZ/PA9NBPm2AbXGz54Hq8k0Digi6nwHq0aeB6vJtA1ALEFIpet4M2uDFgE0eIDelpsndHAap7iRdDfEqVWVB/yuAagnVxG6YUCD7e6EuMPnyZw2BKieZXcSp/ATZr/f2yOLwpxmyhZQGoUDkodhX/dqushdZU+7egCCp2BDM5rAMMCdq1ND3y1pNurkyct3T6bCZQxIT0FcTJtMvndHRjLTuXihJ7aNABTzJ8c00ndPcvg3eEkwMq4Yz4w506o+S9n6/SOuBC0DSI2D1Ph46FxhbNzxm7nqEqQXIqvYMoBUrhSgab19OCDdBj0867DnnKuYK0FF6GSnKO5oVnQvdtZz3Ss2ev7sTAHZNqgcvOSVNq6VGQfpE/dq3l59BTFXQGaoGPfOj/iT9r4Bxn4vBSiFlgLUWUFAWQBqTzEfrxsG1J5BPV63DMjo5Zh4HJRGY4CiYsYBUoVoeyVoKUDqlQWTz5ndMKCJdSs07lS/a1QxWYQm92M3Dahq3ngxrusTyeFxA9V3EDwp5iy9WH3aevjM9S0DKsZ3XcleLxwrQXNpJOOLNdIePfzLUZ0MSVPFkKm4WhhIvmwVQyr0VYi3CUi/8w6WolIc8gIU1+zFnDCzr6JC3djX/fsUgKBlboDczQtDN7Y0en0chnjDgNx5ztQn7aMtcwPkX4K01eRx0FRA9ers2qBeL+HnpLGlGDdcHJBnL5Yo7hYBpdBbB5TwRvINAtLHoqNNdMobybcHyD6MOtIIJb0NeHOAXh9N9zVybT7ljeQehn6AIhvRiIHid6bojAwUU5ag7QFyJWhsoJjwRvLpgOyGxQDZ59fGB4rpbiT3MRTjhgsD8jifOktcZJMNoDQioCXjEpCPDQEBGwICNgQEbACg2PznDsjLjoA8jMYM0fbJGQgyTOvOz04QELS6EUDBJ+3fGqBgdwSUxI6AsBUBASsCAlYAUHT2MwfkbzZqGTB3f2QOMgdUgWEDAREQstsaoFTX5m8VULJr84kATdAsgFacoiu5ZgG04iRvycUSBDRXG7TWJG/JNVMvlnyStwkKvm20mzq5obe7JuPiejFkv4Cl6HxFZDSxoa+78Ced1tHMgIZvJBfNPytGVrZeEifapWEsTdWbBju62hwywkxTgtp/jKtGbm3zfTGZmbj4HtguLtdfOQZxarNmErVVX+EnLLJ6HCx6V9axRc9He7PoW1lFOOqsXLWRruxf1Pq3Wktmsc748M41joY3eznqozQTIJ+D1RagqsuqvfIyp5324wrQZeGpqhBHF5tnBOR1sNpqja4X20tVpy1oN6aucvVags09ln2bZwHkc6ixGc0ByONgNdzppEQLpElcgqLyEJ8oM0AeB6tReYhPlBsgfLAalYf4RNkBmtMpAc2QiIDWT0NAM4SYx+lbAnRLIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICSgrInJG1b7T2mw3t6y/15ZHa3iehSRMQTF/vPATH0UoKyLwMqzKTNZ19MmBnZ67tfRLaNP7BXh/V69oVy6A4RkkBuatl5vpQgec3P5ur2LW9T0KbJiCYmXu2fPc5KI5VUkDl7iJHwP4sDno3a3uPhC5NeDD7EjPPOE5JARW/MnXdlH6vSU8NIGfvl9BsDw1WtNwHZDAlIDMdd3GwtdurjpsXrzl7v4Q6TWgwda0zMI5W+m5eZn8JQIHBzq6NXh+QrN+LVLGgYOZa+dpVzEgGD2gDgxvpqgvIL1jZflvBeo20feVlqzvFOgd38x2ofsHcTRerd/M6onqVrf847Bw+UHS9mHcw8yrOKjiOVtoqZl9obV/p6JPCVpfa3iehTeMdrDS3pCiboDhaPFgFIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgoNwBvRz/dBRRr3hPpPwBqbvkJ77kfYryB3Rwt9uto/wBnTpzgy0uAgIiICACAiIgIAICyh3Q6iIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiIKD/A26mu+Dy3KmQAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">plot</span>(n,power[,<span class="dv">3</span>],<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">pch=</span><span class="dv">0</span>,<span class="dt">main=</span><span class="st">&#39;power for model2&#39;</span>,<span class="dt">xlab=</span><span class="st">&#39;n&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;power&#39;</span>)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">lines</span>(n,power[,<span class="dv">4</span>],<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="kw">points</span>(n,power[,<span class="dv">4</span>],<span class="dt">pch=</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb55-4" title="4"><span class="kw">legend</span>(<span class="dt">x=</span><span class="dv">180</span>,<span class="dt">y=</span><span class="fl">0.6</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;dcov&#39;</span>,<span class="st">&#39;ball&#39;</span>),<span class="dt">pch=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>),<span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>from the result, we can conclude that under the significance level <span class="math inline">\(\alpha=0.01\)</span>, the power of distance correlation test is better than ball test for both models, when the sample size n is large enough, the power of distance correlation test can reach 1, on the contrary, the power of ball test keeps 0 no matter how sample size changed.</p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="exercise-9.4" class="section level2">
<h2>exercise 9.4</h2>
<ul>
<li><p>question: Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p></li>
<li><p>solution: For standard Laplace distribution, the pdf is: <span class="math display">\[
f(x)=\frac{1}{2}e^{-|x|}
\]</span></p></li>
</ul>
<p>its mean is 0 and its standard deviation is <span class="math inline">\(\sqrt{2}\)</span>, so most of the random numbers should within the range <span class="math inline">\(\lbrack -3\sqrt{2},3\sqrt{2}\rbrack\)</span>.</p>
<p>For the increment, we choose normal distibution with mean equals 0 and sd equals 0.05,0.5,2,16, we use function <strong>rw.Metropolis</strong> to plot the chains generated by different increments and calculate the acceptance rates.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1468</span>)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="co"># pdf of standard Laplace distribution</span></a>
<a class="sourceLine" id="cb56-3" title="3">laplace&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb56-4" title="4"></a>
<a class="sourceLine" id="cb56-5" title="5">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb56-6" title="6">  </a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co"># N is the number of iterations</span></a>
<a class="sourceLine" id="cb56-8" title="8">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb56-9" title="9"><span class="co"># x0 is the initial value</span></a>
<a class="sourceLine" id="cb56-10" title="10">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb56-11" title="11"></a>
<a class="sourceLine" id="cb56-12" title="12"><span class="co"># u determines whether accept Y as x(t+1) or not</span></a>
<a class="sourceLine" id="cb56-13" title="13">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb56-14" title="14"></a>
<a class="sourceLine" id="cb56-15" title="15"><span class="co"># k denotes the times of rejection</span></a>
<a class="sourceLine" id="cb56-16" title="16">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb56-17" title="17"></a>
<a class="sourceLine" id="cb56-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb56-19" title="19"><span class="co"># the candidate is from x[i-1] plus a normal increment ~ N(0,sigma)</span></a>
<a class="sourceLine" id="cb56-20" title="20">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb56-21" title="21"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb56-22" title="22">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb56-23" title="23">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb56-24" title="24">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb56-25" title="25">}</a>
<a class="sourceLine" id="cb56-26" title="26">}</a>
<a class="sourceLine" id="cb56-27" title="27"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb56-28" title="28">}</a>
<a class="sourceLine" id="cb56-29" title="29"></a>
<a class="sourceLine" id="cb56-30" title="30"></a>
<a class="sourceLine" id="cb56-31" title="31">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb56-32" title="32">N=<span class="dv">2000</span></a>
<a class="sourceLine" id="cb56-33" title="33">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb56-34" title="34">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb56-35" title="35">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb56-36" title="36">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb56-37" title="37">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb56-38" title="38"></a>
<a class="sourceLine" id="cb56-39" title="39"></a>
<a class="sourceLine" id="cb56-40" title="40"><span class="co">##par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb56-41" title="41"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.05&#39;</span>)</a>
<a class="sourceLine" id="cb56-42" title="42"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.5&#39;</span>)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=2&#39;</span>)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=16&#39;</span>)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">accept_rate&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>(N<span class="dv">-1</span>), <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>(N<span class="dv">-1</span>), <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>(N<span class="dv">-1</span>), <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>(N<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">names</span>(accept_rate)&lt;-<span class="kw">c</span>(<span class="st">&#39;sd=0.05&#39;</span>,<span class="st">&#39;sd=0.5&#39;</span>,<span class="st">&#39;sd=2&#39;</span>,<span class="st">&#39;sd=16&#39;</span>)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="kw">print</span>(accept_rate)</a></code></pre></div>
<pre><code>##   sd=0.05    sd=0.5      sd=2     sd=16 
## 0.9784892 0.8309155 0.5207604 0.1070535</code></pre>
<p>From the result of the acceptance rates, we can conclude that, none of the four acceptance rates is within the range<span class="math inline">\(\lbrack 0.15,0.5\rbrack\)</span>, however, the third one is the nearest among the four increments, when sd equals 16, the acceptance rate is very low, so that we reject most of the candidate random numbers, this condition is inefficient. On the contrary, when sd equals 0.05, most of the candidates points are accepted so that the convergence speed is very slow.</p>
<p>In conclusion, when sd equals 0.5 or 2, the random walk Metropolis sampler performs well.</p>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="section-5" class="section level2">
<h2>11.1</h2>
<ul>
<li><p>Question: The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(logx) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality?</p></li>
<li><p>Solution:</p></li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># example</span></a>
<a class="sourceLine" id="cb62-2" title="2">x&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb62-3" title="3">x1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb62-4" title="4">x2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb62-5" title="5">x1<span class="op">==</span>x2</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">all.equal</span>(x1,x2)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">x&lt;-<span class="fl">0.001</span></a>
<a class="sourceLine" id="cb66-2" title="2">x1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb66-3" title="3">x2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb66-4" title="4">x1<span class="op">==</span>x2</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">all.equal</span>(x1,x2)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>From the result, we can know that the property does not hold exactly when s is extremely large or extremely small, and the identity hold with near equality.</p>
</div>
<div id="section-6" class="section level2">
<h2>11.5</h2>
<ul>
<li>Question: Write a function to solve the equation:</li>
</ul>
<p><span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u &amp; \\
 = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \end{aligned}
\]</span></p>
<p>for <span class="math inline">\(a\)</span>, where:</p>
<p><span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<ul>
<li>Solution: we write function <strong>f_1</strong>, <strong>f_2</strong> to denote the equation to be solved and use function <strong>uniroot</strong> to find the solution in the interval <span class="math inline">\((0,\sqrt{k})\)</span></li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb70-2" title="2"></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="co"># 11.5</span></a>
<a class="sourceLine" id="cb70-4" title="4">CK&lt;-<span class="cf">function</span>(a,k) <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb70-5" title="5"></a>
<a class="sourceLine" id="cb70-6" title="6">Coef1&lt;-<span class="cf">function</span>(k) <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">/</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>((k <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8">Coef2&lt;-<span class="cf">function</span>(k) <span class="kw">return</span>(<span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">/</span>(pi<span class="op">*</span>k))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb70-9" title="9"></a>
<a class="sourceLine" id="cb70-10" title="10">f1&lt;-<span class="cf">function</span>(u,k) <span class="kw">return</span>((<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-11" title="11">f2&lt;-<span class="cf">function</span>(u,k) <span class="kw">return</span>((<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">+</span>k)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-12" title="12"></a>
<a class="sourceLine" id="cb70-13" title="13"><span class="co"># f_1=0 is the equation to be solved</span></a>
<a class="sourceLine" id="cb70-14" title="14">f_<span class="dv">1</span>&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb70-15" title="15">  ck&lt;-<span class="kw">CK</span>(<span class="dt">a=</span>a,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb70-16" title="16">  ck_<span class="dv">1</span>&lt;-<span class="kw">CK</span>(<span class="dt">a=</span>a,<span class="dt">k=</span>k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb70-17" title="17">  coef1&lt;-<span class="kw">Coef1</span>(<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb70-18" title="18">  coef2&lt;-<span class="kw">Coef2</span>(<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb70-19" title="19">  integ1&lt;-<span class="kw">integrate</span>(f1, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span>ck_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb70-20" title="20">    <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb70-21" title="21">    <span class="dt">k=</span>k)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb70-22" title="22">  </a>
<a class="sourceLine" id="cb70-23" title="23">  integ2&lt;-<span class="kw">integrate</span>(f2, <span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span>ck,</a>
<a class="sourceLine" id="cb70-24" title="24">    <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb70-25" title="25">    <span class="dt">k=</span>k)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb70-26" title="26">  </a>
<a class="sourceLine" id="cb70-27" title="27"> coef1<span class="op">*</span>integ1<span class="op">-</span>coef2<span class="op">*</span>integ2</a>
<a class="sourceLine" id="cb70-28" title="28">}</a>
<a class="sourceLine" id="cb70-29" title="29"></a>
<a class="sourceLine" id="cb70-30" title="30"><span class="co"># we use function solu_find to find the solution</span></a>
<a class="sourceLine" id="cb70-31" title="31">solu_find&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb70-32" title="32"> interval&lt;-<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb70-33" title="33"> <span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> interval, <span class="dt">k=</span>k)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-34" title="34">}</a>
<a class="sourceLine" id="cb70-35" title="35"></a>
<a class="sourceLine" id="cb70-36" title="36"></a>
<a class="sourceLine" id="cb70-37" title="37"></a>
<a class="sourceLine" id="cb70-38" title="38"><span class="co"># 11.4</span></a>
<a class="sourceLine" id="cb70-39" title="39"></a>
<a class="sourceLine" id="cb70-40" title="40"><span class="co">## f_2 and intersec are same as 11.5</span></a>
<a class="sourceLine" id="cb70-41" title="41">f_<span class="dv">2</span>&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb70-42" title="42">  bound1&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb70-43" title="43">  bound2&lt;-<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k)</a>
<a class="sourceLine" id="cb70-44" title="44">  bound1<span class="op">-</span>bound2</a>
<a class="sourceLine" id="cb70-45" title="45">}</a>
<a class="sourceLine" id="cb70-46" title="46">intersec&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb70-47" title="47"><span class="kw">uniroot</span>(f_<span class="dv">2</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.01</span>),<span class="dt">k=</span>k)<span class="op">$</span>root}</a>
<a class="sourceLine" id="cb70-48" title="48"></a>
<a class="sourceLine" id="cb70-49" title="49"></a>
<a class="sourceLine" id="cb70-50" title="50">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb70-51" title="51">root&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">length</span>(k),<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb70-52" title="52"><span class="kw">colnames</span>(root)&lt;-<span class="kw">c</span>(<span class="st">&#39;a1&#39;</span>,<span class="st">&#39;a2&#39;</span>)</a>
<a class="sourceLine" id="cb70-53" title="53"><span class="kw">rownames</span>(root)&lt;-<span class="kw">as.character</span>(k)</a>
<a class="sourceLine" id="cb70-54" title="54"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb70-55" title="55">  root[i,<span class="dv">1</span>]&lt;-<span class="kw">intersec</span>(k[i])</a>
<a class="sourceLine" id="cb70-56" title="56"> <span class="co"># root[i,2]&lt;-solu_find(k[i])</span></a>
<a class="sourceLine" id="cb70-57" title="57">}</a>
<a class="sourceLine" id="cb70-58" title="58"></a>
<a class="sourceLine" id="cb70-59" title="59"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">16</span>){</a>
<a class="sourceLine" id="cb70-60" title="60"> root[i,<span class="dv">2</span>]&lt;-<span class="kw">solu_find</span>(k[i])</a>
<a class="sourceLine" id="cb70-61" title="61">}</a>
<a class="sourceLine" id="cb70-62" title="62"></a>
<a class="sourceLine" id="cb70-63" title="63">root[<span class="dv">17</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">4</span>), <span class="dt">k=</span><span class="dv">20</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-64" title="64">root[<span class="dv">18</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">4</span>), <span class="dt">k=</span><span class="dv">21</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-65" title="65">root[<span class="dv">19</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">4</span>), <span class="dt">k=</span><span class="dv">22</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-66" title="66"></a>
<a class="sourceLine" id="cb70-67" title="67">root[<span class="dv">20</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">sqrt</span>(<span class="dv">23</span>)<span class="op">-</span><span class="fl">0.01</span>), <span class="dt">k=</span><span class="dv">23</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-68" title="68">root[<span class="dv">21</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="kw">sqrt</span>(<span class="dv">24</span>)<span class="op">-</span><span class="fl">0.01</span>), <span class="dt">k=</span><span class="dv">24</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-69" title="69">root[<span class="dv">22</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">5</span><span class="fl">-0.01</span>), <span class="dt">k=</span><span class="dv">25</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-70" title="70">root[<span class="dv">23</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">5</span>), <span class="dt">k=</span><span class="dv">100</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-71" title="71">root[<span class="dv">24</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">10</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">5</span>)<span class="op">-</span><span class="fl">0.1</span>), <span class="dt">k=</span><span class="dv">500</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-72" title="72">root[<span class="dv">25</span>,<span class="dv">2</span>]&lt;-<span class="kw">uniroot</span>(f_<span class="dv">1</span>,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">0.01</span>,<span class="dv">2</span>), <span class="dt">k=</span><span class="dv">1000</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb70-73" title="73">knitr<span class="op">::</span><span class="kw">kable</span>(root,<span class="dt">format =</span> <span class="st">&#39;html&#39;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
a1
</th>
<th style="text-align:right;">
a2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
1.492073
</td>
<td style="text-align:right;">
1.492107
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
1.533555
</td>
<td style="text-align:right;">
1.533529
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
1.562745
</td>
<td style="text-align:right;">
1.562720
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
1.584429
</td>
<td style="text-align:right;">
1.584429
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
1.601185
</td>
<td style="text-align:right;">
1.601208
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
1.614516
</td>
<td style="text-align:right;">
1.614518
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
1.625389
</td>
<td style="text-align:right;">
1.625402
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
1.634418
</td>
<td style="text-align:right;">
1.634437
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
1.642026
</td>
<td style="text-align:right;">
1.642008
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
1.648552
</td>
<td style="text-align:right;">
1.648545
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
1.654175
</td>
<td style="text-align:right;">
1.654174
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
1.659099
</td>
<td style="text-align:right;">
1.659098
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:right;">
1.663453
</td>
<td style="text-align:right;">
1.663445
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:right;">
1.667288
</td>
<td style="text-align:right;">
1.667282
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:right;">
1.670733
</td>
<td style="text-align:right;">
1.670731
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:right;">
1.673832
</td>
<td style="text-align:right;">
1.673831
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:right;">
1.676605
</td>
<td style="text-align:right;">
1.676635
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:right;">
1.679148
</td>
<td style="text-align:right;">
1.679172
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:right;">
1.681468
</td>
<td style="text-align:right;">
1.681485
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:right;">
4.785831
</td>
<td style="text-align:right;">
1.683595
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:right;">
4.888979
</td>
<td style="text-align:right;">
1.685546
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:right;">
4.990000
</td>
<td style="text-align:right;">
1.687366
</td>
</tr>
<tr>
<td style="text-align:left;">
100
</td>
<td style="text-align:right;">
9.990000
</td>
<td style="text-align:right;">
1.720573
</td>
</tr>
<tr>
<td style="text-align:left;">
500
</td>
<td style="text-align:right;">
22.350680
</td>
<td style="text-align:right;">
22.260619
</td>
</tr>
<tr>
<td style="text-align:left;">
1000
</td>
<td style="text-align:right;">
31.612777
</td>
<td style="text-align:right;">
1.730905
</td>
</tr>
</tbody>
</table>
<p>From the result above, we know that, when <span class="math inline">\(k\leq 22\)</span>, the solutions between these two questions are similiar, however, when <span class="math inline">\(k&gt;22\)</span>, the solution for 11.4 grows much faster than the solution for 11.5 as k increases.</p>
</div>
<div id="slides" class="section level2">
<h2>Slides:</h2>
<ul>
<li>Question:</li>
</ul>
<p>** Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>** Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
<ul>
<li>Solution:</li>
</ul>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb71-2" title="2">nA&lt;-<span class="dv">28</span></a>
<a class="sourceLine" id="cb71-3" title="3">nB&lt;-<span class="dv">24</span></a>
<a class="sourceLine" id="cb71-4" title="4">nOO&lt;-<span class="dv">41</span></a>
<a class="sourceLine" id="cb71-5" title="5">nAB&lt;-<span class="dv">70</span></a>
<a class="sourceLine" id="cb71-6" title="6">MLE&lt;-<span class="cf">function</span>(p0,q0){</a>
<a class="sourceLine" id="cb71-7" title="7">  C1&lt;-<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>p0<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p0<span class="dv">-2</span><span class="op">*</span>q0)</a>
<a class="sourceLine" id="cb71-8" title="8">  C2&lt;-<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p0<span class="dv">-2</span><span class="op">*</span>q0)</a>
<a class="sourceLine" id="cb71-9" title="9">  C3&lt;-<span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q0<span class="dv">-2</span><span class="op">*</span>p0)</a>
<a class="sourceLine" id="cb71-10" title="10">  D1&lt;-<span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>q0<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q0<span class="dv">-2</span><span class="op">*</span>p0)</a>
<a class="sourceLine" id="cb71-11" title="11">  </a>
<a class="sourceLine" id="cb71-12" title="12">  model&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb71-13" title="13">    f1&lt;-(<span class="op">-</span>C1<span class="dv">-2</span><span class="op">*</span>nOO<span class="op">-</span>nAB<span class="dv">-2</span><span class="op">*</span>C2<span class="op">-</span>C3)<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span>(<span class="op">-</span>C1<span class="op">-</span>nAB<span class="op">-</span>C2)<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">+</span>C1<span class="op">+</span>C2<span class="op">+</span>nAB</a>
<a class="sourceLine" id="cb71-14" title="14">    f2&lt;-(<span class="op">-</span>D1<span class="op">-</span>nAB<span class="op">-</span>C3)<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">+</span>(<span class="op">-</span>D1<span class="dv">-2</span><span class="op">*</span>nOO<span class="op">-</span>nAB<span class="dv">-2</span><span class="op">*</span>C3<span class="op">-</span>C2)<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">+</span>D1<span class="op">+</span>nAB<span class="op">+</span>C3</a>
<a class="sourceLine" id="cb71-15" title="15">    <span class="kw">c</span>(<span class="dt">F1=</span>f1,<span class="dt">F2=</span>f2)</a>
<a class="sourceLine" id="cb71-16" title="16">  }</a>
<a class="sourceLine" id="cb71-17" title="17">  </a>
<a class="sourceLine" id="cb71-18" title="18">  <span class="kw">return</span>(<span class="kw">multiroot</span>(<span class="dt">f=</span>model,<span class="dt">start=</span><span class="kw">c</span>(p0,q0))<span class="op">$</span>root)</a>
<a class="sourceLine" id="cb71-19" title="19">}</a>
<a class="sourceLine" id="cb71-20" title="20"></a>
<a class="sourceLine" id="cb71-21" title="21"><span class="co"># set the maximum number of iterations to 50</span></a>
<a class="sourceLine" id="cb71-22" title="22">N&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb71-23" title="23">PQ&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> N,<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb71-24" title="24"><span class="kw">colnames</span>(PQ)&lt;-<span class="kw">c</span>(<span class="st">&#39;p&#39;</span>,<span class="st">&#39;q&#39;</span>)</a>
<a class="sourceLine" id="cb71-25" title="25"></a>
<a class="sourceLine" id="cb71-26" title="26"><span class="co"># the initial value of p and q is 1/2,1/3</span></a>
<a class="sourceLine" id="cb71-27" title="27">p0&lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb71-28" title="28">q0&lt;-<span class="dv">1</span><span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb71-29" title="29">tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb71-30" title="30"></a>
<a class="sourceLine" id="cb71-31" title="31"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb71-32" title="32">old&lt;-<span class="kw">c</span>(p0,q0)</a>
<a class="sourceLine" id="cb71-33" title="33">new&lt;-<span class="kw">MLE</span>(p0,q0)</a>
<a class="sourceLine" id="cb71-34" title="34"><span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>((new <span class="op">-</span><span class="st"> </span>old)<span class="op">/</span>old)) <span class="op">&lt;</span><span class="st"> </span>tol) {</a>
<a class="sourceLine" id="cb71-35" title="35">  iter&lt;-i<span class="dv">-1</span></a>
<a class="sourceLine" id="cb71-36" title="36">  <span class="cf">break</span></a>
<a class="sourceLine" id="cb71-37" title="37">}</a>
<a class="sourceLine" id="cb71-38" title="38">PQ[i,]&lt;-new</a>
<a class="sourceLine" id="cb71-39" title="39">p0&lt;-new[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb71-40" title="40">q0&lt;-new[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb71-41" title="41">}</a>
<a class="sourceLine" id="cb71-42" title="42"></a>
<a class="sourceLine" id="cb71-43" title="43"><span class="kw">cat</span>(<span class="st">&#39;EM algorithm converged in&#39;</span>,iter,<span class="st">&#39;iterations&#39;</span>,<span class="dt">sep=</span><span class="st">&#39; &#39;</span>)</a></code></pre></div>
<pre><code>## EM algorithm converged in 10 iterations</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="co"># calculate the log-maximum likelihood values in M-steps </span></a>
<a class="sourceLine" id="cb73-2" title="2">PQ&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),PQ[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,])</a>
<a class="sourceLine" id="cb73-3" title="3">loglik&lt;-<span class="cf">function</span>(p0,q0,p,q){</a>
<a class="sourceLine" id="cb73-4" title="4">  <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>p0<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p0<span class="dv">-2</span><span class="op">*</span>q0)<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>q0<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q0<span class="dv">-2</span><span class="op">*</span>p0)<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span></a>
<a class="sourceLine" id="cb73-5" title="5"><span class="st">           </span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q0<span class="dv">-2</span><span class="op">*</span>p0)<span class="op">*</span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="st">           </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p0<span class="dv">-2</span><span class="op">*</span>q0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)))</a>
<a class="sourceLine" id="cb73-7" title="7">}</a>
<a class="sourceLine" id="cb73-8" title="8">max_log_lik&lt;-<span class="kw">numeric</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb73-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) max_log_lik[i]&lt;-<span class="kw">loglik</span>(PQ[i,<span class="dv">1</span>],PQ[i,<span class="dv">2</span>],PQ[i<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>],PQ[i<span class="op">+</span><span class="dv">1</span>,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb73-10" title="10"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,max_log_lik,<span class="dt">xlab=</span><span class="st">&#39;iter&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;loglik&#39;</span>,<span class="dt">type=</span><span class="st">&#39;b&#39;</span>,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">main=</span><span class="st">&#39;the log-maximum likelihood values in M-steps&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkLZmkNtmtttmtv+QOgCQOmaQZgCQZjqQkDqQkGaQkLaQkNuQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2kDq2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb/7bb////tmb/25D/27b//7b//9v///+EHRxfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKHElEQVR4nO2de2PbNBTFna4hgY6NhA1YysaAQdMBhXoP4jbx9/9Y08N25MjW8SOOFfucPzY3lq+ufpau5IfkIKacCvp2wHcREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREFArQLvrYLppepw+eB1c3Lv2h8HkpqLVQlPNnDXSEhBI20sTM/IvB6Q3+wFkKFDH7G6D4PJmn8N2Gcw+XQWTV/GHudghf/r0IgiCp2LzYS6Tiewu7lWedlptR/y+KDIU2zVIpLq4015Mnm8Oa9Cfyjl14KeXQfDkx83h9u5WGH+XuZ9sREGwMvw2a6zyzcgwjj9cic1ndzmYOu+pdkhocmUC0rqS/8hfI/23PJ1hIKyHMvcU0EHaPKCDnQWAxJa0m6S9vM8D0lKHJn+oimBsa/f39jUZYVrs3PttA9pnmFrLOZj+uFAWZ5vdOsgBWsQfxd5Xmoc44quNrDwLdfTk97m0kAHKpT0ElN9pA/rvOi2QqEYqizyg6V1y6MM8+eVgW7t/m7kvjpwl+Rt+24D2GcqKvpFuLg4AXd4pq9lRBiCRQP+rqQh9/ktUA5Gz/EXXpRTQQdo8INvQAaAftF9JtQ/Tpps5uTIKdJ+2IHvbcF/a2EevxG8LkJGhcO3yHyPwGHnLkqbhSx6sqt30/2VyDmZxWm3e6Po2041clymLQfm0BzEov9MClMDW2PVfVi+mDKRuhobLyfbMCD3a1CpJsffbApTPMNhHNyMG3QhAwUr77wQkLVz++jlJGM11mZyAsrqLAamiJNGiHFDqZmS4HB24n9mfZeEg9dsEpHYaGcaPL/TWHwWAKtUgnV3iiuI93RwL0PS9akbytMfW/mo1KHM/ztrYL+pAw28LkJGh0OPbqzT+HwAqiUH5ckVpGXSrlZ3SohSQLlQUVAOkTooOVDMnoOoxSLeepFquYjNIW76Zkee1Eeb3gEp6MasGTTeP10Hyg6xiac9ZBEj8KxNXBJQUYy2HS4/LdJcNyN2LGe7rKLmKY9PvLPCmvhkZCgvfbWQ7K6hBZeMgOwbtg504LsrytBlk0a8qIL2ZDEtS8DagsnFQEshMQFHyR95v3ZVmo5t9hvFtFo0sQPoHkeDbu3U5INUbXL6TXWKkezDh1KoEUPwgQt6zvyv2YllMiB/fCO/laLYMkB49/6SNGNu79/PgySvzUiNrPnu/k1C1983IMI4/ygj01BpJ3+SuxdbNLj2HLQVI1Ibn6jTOUPLxSQFKRwSVL5xHJN3EHl/OzYtZai/ecgUiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAjoyoOBs1BegI5o6LIRdqhZJzg/QYUms02yf9zZJzg7QYUmshmC3jFZJfAdUeKadhT1vQHVjX3HNHzCgmuYqlGTcMaigthWWzTrKttM0ydkBKihbp/IbUEF9ObU8B3Tq+lLgwNET9mKuO3UEaH1xr6aDlL5xPnJAis/XanLJqjgFNucJwk4AbZdykpWazxGWTHuB5jzh0xUgOVVeTWmKShY5QOZ84dNVExO1J2xTg7zh0xGg7VLOS5OTIMuitD8EgLrq5pOJU6XzykYPqKG53seFlvwC1P+VhaWuBoqidamJxCXDoGJztW4VnUjdAArVNOVZMiKqbG40gIwOrFY3PxpA6gJDDxHrDRT94+NXDRpPL5bFoOSCo6W5PnXiXqzuU43+5dc4yEMREFBHgMK0dYUNb3d4o46CtOjBtku1kg8BFUj3XbtrubROvXFQjUxOpO4GikLr6YaAipSNftYzAipUisVccK6COQ/5dNeL6Ua2ux4foO1v+v/dz65FmRvlOxBA+hZP5F61Wqr0Qqws32EAEmgKFqcs0lgBqScWsPrE9QH5yKdZkI6C8pIbGi8gQajsZrypMQLKlp6v2Mpq5TsEQF3m6yUfAkIiIKDaMWiRhaFjx6BBAOoyXwKKnU81/OTjUQ0aBqAOx0HDANRhvgQEzA0GkNHKqlyQVc3XUz5N7wep69XSt6Oa5DscQLtrfassnG7K3m1pku9wAKUPvaKL+7K3o5rkOxxA6V2esPypYIN8feXTKgalje0Y+Q4JkO7H5NeoWgwVBw2oi3wJCJgbFKDs45fHy9dbPs2DdNhmHD1oQEY3f7x8hwTIGCgeL98hAWINQgk7iEH+8vGkFxsYoOPnS0CZleKnGgQEzA0HUDdPNTzm40cNIiBgjoCAOQJym/OZT1eAas0XGyGgevPFxgeo5nyx8QGqOV9sfIDqzRfzmk9XMajOfLExAqo1X2yUgOqYIyBgbpSA1LodrlesgoItL9UNILVMaeh6fD9uQEk3v84WLHWZGyOgZKAoHwzhFajGCCitQbMK12Ke8+nwYlUFIn3F6jI3TkBq3u+kgI/9VGOkgKqbIyBgbqSAKt9R9J1P73cUxwmoxh3FcQJqvAKVh/LgjqLf8uCOot/y4I6i3+p9HOS7ugQEV385hzVv+wR0FqsC9wjoPNZNJiAgAgLqsxc7Bz79dvNnwIfjIKTeAJ2NegLUIhuc5ChG6paYgI6bvKkIqH02BNQ6CQGdwggBHSFJi+RNRUDtsxk3oPMVAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQCQCpSWZ4ieq1e/E0uT4WWGM2e0m51MY36rWvqM5CW90D2l0Lb0L4YbcocAKKxN7SGSJa8iVl5/ettkv1Xpz8IHxUmVD3gB7m0me0BPN26QSkX5hwGtGLGJdNZItVxZHHa1OOdHmdKgahUxZOX7sAqbmObiFAUbBQs9yqnbBMpwIE1mAWAJwxKLr4d4kCGWxiehqgZl15Pc0TAQJfB5TV3gkolK0DrQQOg6+iouty5SB0GkARiNFylqcb0ASfdllJH+auE+EtIPR1SVXr3YAUGh0+yozg2OJrEwvRKChMXkkpL74ujzNUV6gZngbpisvDOmuQnkfjPO264M4kkZfdvDss7OUeScso5Xp7NK4cg7wbKCbtB3oELjUifL2yRkmS6hX6dalx5iIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAIC8haQep8javXZ4KPIW0BS6eKxfYqAgLwFJODIl+vl0sz6rZbt92/bfQO2mXwGpGuQfH9Tvhe1Xbb60HtTeQ9ou5TvREUX93rj5PIekH5Z7mG+6ikg+Q8ofQOWgPLK16C4ty7Ne0AZFwLKKwvQahbCenJDQHkpHut0HCQGQATkpwgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOgL4QFjjGjC+tIAAAAASUVORK5CYII=" /><!-- --></p>
<p>From the result, we can conclude that the MLE of p and q calculated by EM algorithm is 0.3273442 and 0.3104267, from the figure above, the log-maximum likelihood values in M-steps are increasing and converge in 10 iterations.</p>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="section-7" class="section level2">
<h2>3</h2>
<ul>
<li><p>question: Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in list formulas.</p></li>
<li><p>solution:</p></li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">formulas&lt;-<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb74-2" title="2">  mpg<span class="op">~</span>disp,</a>
<a class="sourceLine" id="cb74-3" title="3">  mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp),</a>
<a class="sourceLine" id="cb74-4" title="4">  mpg<span class="op">~</span>disp<span class="op">+</span>wt,</a>
<a class="sourceLine" id="cb74-5" title="5">  mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt</a>
<a class="sourceLine" id="cb74-6" title="6">)</a>
<a class="sourceLine" id="cb74-7" title="7"></a>
<a class="sourceLine" id="cb74-8" title="8"><span class="co"># lapply</span></a>
<a class="sourceLine" id="cb74-9" title="9">fit1&lt;-<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="cf">function</span>(i) <span class="kw">lm</span>(<span class="dt">formula =</span> formulas[[i]],<span class="dt">data=</span>mtcars))</a>
<a class="sourceLine" id="cb74-10" title="10"></a>
<a class="sourceLine" id="cb74-11" title="11"><span class="co"># forloop</span></a>
<a class="sourceLine" id="cb74-12" title="12"></a>
<a class="sourceLine" id="cb74-13" title="13">fit2&lt;-<span class="kw">vector</span>(<span class="st">&#39;list&#39;</span>,<span class="dt">length =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb74-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) fit2[[i]]&lt;-<span class="kw">lm</span>(<span class="dt">formula =</span> formulas[[i]],<span class="dt">data=</span>mtcars)</a></code></pre></div>
</div>
<div id="section-8" class="section level2">
<h2>4</h2>
<ul>
<li><p>question: Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p></li>
<li><p>solution:</p></li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">bootstrap&lt;-<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb75-2" title="2">  rows&lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars),<span class="dt">rep=</span>T)</a>
<a class="sourceLine" id="cb75-3" title="3">  mtcars[rows,]</a>
<a class="sourceLine" id="cb75-4" title="4">})</a>
<a class="sourceLine" id="cb75-5" title="5"></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="co"># lapply without anonymous function</span></a>
<a class="sourceLine" id="cb75-7" title="7"></a>
<a class="sourceLine" id="cb75-8" title="8">fit<span class="fl">.1</span>&lt;-<span class="kw">lapply</span>(bootstrap, <span class="dt">FUN =</span> lm, <span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb75-9" title="9"></a>
<a class="sourceLine" id="cb75-10" title="10"><span class="co"># for loop</span></a>
<a class="sourceLine" id="cb75-11" title="11"></a>
<a class="sourceLine" id="cb75-12" title="12">fit<span class="fl">.2</span>&lt;-<span class="kw">vector</span>(<span class="st">&#39;list&#39;</span>,<span class="dt">length =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb75-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstrap)) fit<span class="fl">.2</span>[[i]]&lt;-<span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data=</span>bootstrap[[i]])</a></code></pre></div>
</div>
<div id="section-9" class="section level2">
<h2>5</h2>
<ul>
<li><p>question: For each model in the previous two exercises, extract R2 using the function below.</p></li>
<li><p>solution:</p></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">rsq&lt;-<span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb76-2" title="2"></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="co"># exercise 3</span></a>
<a class="sourceLine" id="cb76-4" title="4">R2<span class="fl">.1</span>&lt;-<span class="kw">sapply</span>(fit1,rsq)</a>
<a class="sourceLine" id="cb76-5" title="5">R2<span class="fl">.2</span>&lt;-<span class="kw">sapply</span>(fit2,rsq)</a>
<a class="sourceLine" id="cb76-6" title="6"><span class="kw">rbind</span>(R2<span class="fl">.1</span>,R2<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]
## R2.1 0.7183433 0.8596865 0.7809306 0.8838038
## R2.1 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># exercise 4</span></a>
<a class="sourceLine" id="cb78-2" title="2">R2_<span class="dv">1</span>&lt;-<span class="kw">sapply</span>(fit<span class="fl">.1</span>,rsq)</a>
<a class="sourceLine" id="cb78-3" title="3">R2_<span class="dv">2</span>&lt;-<span class="kw">sapply</span>(fit<span class="fl">.2</span>,rsq)</a>
<a class="sourceLine" id="cb78-4" title="4"><span class="kw">rbind</span>(R2_<span class="dv">1</span>,R2_<span class="dv">2</span>)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]     [,6]     [,7]
## R2_1 0.7464041 0.6993453 0.6531206 0.7994781 0.7468001 0.721455 0.572071
## R2_2 0.7464041 0.6993453 0.6531206 0.7994781 0.7468001 0.721455 0.572071
##           [,8]      [,9]     [,10]
## R2_1 0.6879973 0.7198123 0.6797097
## R2_2 0.6879973 0.7198123 0.6797097</code></pre>
</div>
<div id="section-10" class="section level2">
<h2>3</h2>
<ul>
<li><p>question: The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p></li>
<li><p>solution:</p></li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">trails&lt;-<span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb80-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb80-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb80-4" title="4">  <span class="dt">simplify=</span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb80-5" title="5">)</a>
<a class="sourceLine" id="cb80-6" title="6"></a>
<a class="sourceLine" id="cb80-7" title="7"><span class="co"># sapply with anonymous function</span></a>
<a class="sourceLine" id="cb80-8" title="8">pvalue&lt;-<span class="kw">sapply</span>(trails,<span class="cf">function</span>(test) test<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb80-9" title="9"></a>
<a class="sourceLine" id="cb80-10" title="10"><span class="co"># sapply without anonymous function</span></a>
<a class="sourceLine" id="cb80-11" title="11">pvalue1&lt;-<span class="kw">sapply</span>(trails,<span class="st">&#39;[[&#39;</span>,<span class="st">&#39;p.value&#39;</span>)</a>
<a class="sourceLine" id="cb80-12" title="12"></a>
<a class="sourceLine" id="cb80-13" title="13">pvalue</a></code></pre></div>
<pre><code>##   [1] 0.4938048797 0.8620949251 0.3504689635 0.9420185712 0.5263448233
##   [6] 0.3521414698 0.0127682276 0.5402460001 0.0746784728 0.5411813168
##  [11] 0.8045489438 0.3676376645 0.7762896729 0.4240890592 0.0007980711
##  [16] 0.3401059798 0.1693764207 0.4337886777 0.2835808400 0.5264921860
##  [21] 0.0693481469 0.9858684783 0.9542298095 0.1738896310 0.2701016371
##  [26] 0.0260064904 0.2865781608 0.4746494731 0.8978917440 0.1765381821
##  [31] 0.3637523872 0.2335259491 0.4410981505 0.0608720404 0.7051793496
##  [36] 0.6355249703 0.8665947705 0.6664071259 0.0217275613 0.8543913521
##  [41] 0.4137607092 0.3302549253 0.3297817676 0.4750263396 0.3170535639
##  [46] 0.8014603431 0.0984073408 0.4339524172 0.8676917445 0.2438336974
##  [51] 0.7055659579 0.2964546974 0.0598742189 0.8791586953 0.2794348439
##  [56] 0.2208615398 0.6883664680 0.2105309747 0.3455035904 0.7569851816
##  [61] 0.9937747891 0.4102364598 0.3903592963 0.2735588406 0.6074858493
##  [66] 0.3225187665 0.7480901232 0.6365061354 0.0851615460 0.2237732205
##  [71] 0.3622354651 0.2372208009 0.3333385860 0.9572207088 0.9423646802
##  [76] 0.6519335169 0.5922680483 0.2352711810 0.5506242903 0.2370442062
##  [81] 0.3189216406 0.1131106354 0.7113865765 0.5029850649 0.8224636122
##  [86] 0.2431893970 0.8197765613 0.1217353836 0.8705831249 0.7944998359
##  [91] 0.2094987931 0.9818830561 0.7016845283 0.5310075193 0.9139113512
##  [96] 0.5624703008 0.5327434115 0.2801300074 0.1597483243 0.8732458132</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">pvalue1</a></code></pre></div>
<pre><code>##   [1] 0.4938048797 0.8620949251 0.3504689635 0.9420185712 0.5263448233
##   [6] 0.3521414698 0.0127682276 0.5402460001 0.0746784728 0.5411813168
##  [11] 0.8045489438 0.3676376645 0.7762896729 0.4240890592 0.0007980711
##  [16] 0.3401059798 0.1693764207 0.4337886777 0.2835808400 0.5264921860
##  [21] 0.0693481469 0.9858684783 0.9542298095 0.1738896310 0.2701016371
##  [26] 0.0260064904 0.2865781608 0.4746494731 0.8978917440 0.1765381821
##  [31] 0.3637523872 0.2335259491 0.4410981505 0.0608720404 0.7051793496
##  [36] 0.6355249703 0.8665947705 0.6664071259 0.0217275613 0.8543913521
##  [41] 0.4137607092 0.3302549253 0.3297817676 0.4750263396 0.3170535639
##  [46] 0.8014603431 0.0984073408 0.4339524172 0.8676917445 0.2438336974
##  [51] 0.7055659579 0.2964546974 0.0598742189 0.8791586953 0.2794348439
##  [56] 0.2208615398 0.6883664680 0.2105309747 0.3455035904 0.7569851816
##  [61] 0.9937747891 0.4102364598 0.3903592963 0.2735588406 0.6074858493
##  [66] 0.3225187665 0.7480901232 0.6365061354 0.0851615460 0.2237732205
##  [71] 0.3622354651 0.2372208009 0.3333385860 0.9572207088 0.9423646802
##  [76] 0.6519335169 0.5922680483 0.2352711810 0.5506242903 0.2370442062
##  [81] 0.3189216406 0.1131106354 0.7113865765 0.5029850649 0.8224636122
##  [86] 0.2431893970 0.8197765613 0.1217353836 0.8705831249 0.7944998359
##  [91] 0.2094987931 0.9818830561 0.7016845283 0.5310075193 0.9139113512
##  [96] 0.5624703008 0.5327434115 0.2801300074 0.1597483243 0.8732458132</code></pre>
</div>
<div id="section-11" class="section level2">
<h2>7</h2>
<ul>
<li><p>question: Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p></li>
<li><p>solution: I think <strong>mvapply</strong> can be implemented, since for vapply, we can also compute each element in any order, itâ€™s natural to dispatch the tasks to different cores, and compute them in parallel.</p></li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb84-2" title="2">cl&lt;-<span class="kw">makeCluster</span>(<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb84-3" title="3"></a>
<a class="sourceLine" id="cb84-4" title="4"><span class="co"># use parallel</span></a>
<a class="sourceLine" id="cb84-5" title="5"><span class="co">#mcsapply&lt;-function(X,FUN,mc.cores=1L){</span></a>
<a class="sourceLine" id="cb84-6" title="6">  </a>
<a class="sourceLine" id="cb84-7" title="7"> <span class="co"># res&lt;-mclapply(X,FUN = FUN, mc.cores = mc.cores)</span></a>
<a class="sourceLine" id="cb84-8" title="8"> <span class="co">#simplify2array(res)</span></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="co">#}</span></a>
<a class="sourceLine" id="cb84-10" title="10"></a>
<a class="sourceLine" id="cb84-11" title="11"></a>
<a class="sourceLine" id="cb84-12" title="12"><span class="co"># use parLapply</span></a>
<a class="sourceLine" id="cb84-13" title="13">mcsapply2&lt;-<span class="cf">function</span>(<span class="dt">cl =</span> cl, X, FUN, <span class="dt">simplify =</span> <span class="ot">TRUE</span>,<span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>, <span class="dt">chunk.size =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb84-14" title="14">  <span class="kw">parSapply</span>(<span class="dt">cl =</span> cl, <span class="dt">X=</span>X, <span class="dt">FUN=</span>FUN, <span class="dt">simplify =</span> simplify,</a>
<a class="sourceLine" id="cb84-15" title="15">          <span class="dt">USE.NAMES =</span> USE.NAMES, <span class="dt">chunk.size =</span> chunk.size)</a>
<a class="sourceLine" id="cb84-16" title="16">}</a>
<a class="sourceLine" id="cb84-17" title="17"></a>
<a class="sourceLine" id="cb84-18" title="18"><span class="co"># time spent by sapply</span></a>
<a class="sourceLine" id="cb84-19" title="19"><span class="co"># (sapply(trails,&#39;[[&#39;,&#39;p.value&#39;))</span></a>
<a class="sourceLine" id="cb84-20" title="20"></a>
<a class="sourceLine" id="cb84-21" title="21"><span class="co"># time spent by mcsapply</span></a>
<a class="sourceLine" id="cb84-22" title="22"><span class="co"># system.time(mcsapply2(cl,trails,function(test) test$p.value))</span></a>
<a class="sourceLine" id="cb84-23" title="23"></a>
<a class="sourceLine" id="cb84-24" title="24"><span class="co"># parSapply(cl,trails , function(test) test$p.value)</span></a></code></pre></div>
</div>
</div>
<div id="homework-11" class="section level1">
<h1>Homework 11</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Rewrite an Rcpp function for the same task as in exercise 9.4.</p>
</div>
<div id="solution-1" class="section level2">
<h2>Solution 1</h2>
<p>We write function <strong>rw.metropolis</strong> as the R random number generater, and <strong>Metropolis</strong> as the C++ random number generater (see attached), then we draw the figures under different variance scenarios.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="co">## 1.  R random number generater</span></a>
<a class="sourceLine" id="cb85-3" title="3"></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co"># pdf of standard Laplace distribution</span></a>
<a class="sourceLine" id="cb85-5" title="5">laplace&lt;-<span class="cf">function</span>(x) <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb85-6" title="6"></a>
<a class="sourceLine" id="cb85-7" title="7">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb85-8" title="8">  </a>
<a class="sourceLine" id="cb85-9" title="9"><span class="co"># N is the number of iterations</span></a>
<a class="sourceLine" id="cb85-10" title="10">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb85-11" title="11"><span class="co"># x0 is the initial value</span></a>
<a class="sourceLine" id="cb85-12" title="12">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb85-13" title="13"></a>
<a class="sourceLine" id="cb85-14" title="14"><span class="co"># u determines whether accept Y as x(t+1) or not</span></a>
<a class="sourceLine" id="cb85-15" title="15">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb85-16" title="16"></a>
<a class="sourceLine" id="cb85-17" title="17"><span class="co"># k denotes the times of rejection</span></a>
<a class="sourceLine" id="cb85-18" title="18">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb85-19" title="19"></a>
<a class="sourceLine" id="cb85-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb85-21" title="21"><span class="co"># the candidate is from x[i-1] plus a normal increment ~ N(0,sigma)</span></a>
<a class="sourceLine" id="cb85-22" title="22">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb85-23" title="23"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">laplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">laplace</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb85-24" title="24">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb85-25" title="25">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb85-26" title="26">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb85-27" title="27">}</a>
<a class="sourceLine" id="cb85-28" title="28">}</a>
<a class="sourceLine" id="cb85-29" title="29"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb85-30" title="30">}</a>
<a class="sourceLine" id="cb85-31" title="31"></a>
<a class="sourceLine" id="cb85-32" title="32"></a>
<a class="sourceLine" id="cb85-33" title="33"><span class="co">## 2. C++ random number generater: function(Metropolis)</span></a>
<a class="sourceLine" id="cb85-34" title="34"> <span class="kw">sourceCpp</span>(<span class="st">&#39;~/Metropolis.cpp&#39;</span>)</a>
<a class="sourceLine" id="cb85-35" title="35"></a>
<a class="sourceLine" id="cb85-36" title="36"></a>
<a class="sourceLine" id="cb85-37" title="37">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb85-38" title="38">N=<span class="dv">2000</span></a>
<a class="sourceLine" id="cb85-39" title="39">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb85-40" title="40"></a>
<a class="sourceLine" id="cb85-41" title="41">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb85-42" title="42">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb85-43" title="43">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb85-44" title="44">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb85-45" title="45"></a>
<a class="sourceLine" id="cb85-46" title="46">cpp.rw1&lt;-<span class="kw">Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb85-47" title="47">cpp.rw2&lt;-<span class="kw">Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb85-48" title="48">cpp.rw3&lt;-<span class="kw">Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb85-49" title="49">cpp.rw4&lt;-<span class="kw">Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb85-50" title="50"></a>
<a class="sourceLine" id="cb85-51" title="51"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb85-52" title="52"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.05(R)&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.5(R)&#39;</span>)</a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=2(R)&#39;</span>)</a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=16(R)&#39;</span>)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,cpp.rw1<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.05(Cpp)&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,cpp.rw2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.5(Cpp)&#39;</span>)</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,cpp.rw3<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=2(Cpp)&#39;</span>)</a>
<a class="sourceLine" id="cb91-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,cpp.rw4<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>,<span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab=</span><span class="st">&#39;iteration&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=16(Cpp)&#39;</span>)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">abline</span>(<span class="dt">h=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>),<span class="dv">3</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2" class="section level1">
<h1>Question 2</h1>
<p>Compare the generated random numbers by the two functions using qqplot.</p>
</div>
<div id="solution-2" class="section level1">
<h1>Solution 2</h1>
<p>Because after 500 iterations, the distribution of the random numbers generated by both methods are stable except the scenario sd=0.05, so we use <strong>qqplot</strong> to contrast the data points after the 500th iterations.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">qqplot</span>(rw1<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],cpp.rw1<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],<span class="dt">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.05&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">qqplot</span>(rw2<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],cpp.rw2<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],<span class="dt">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=0.5&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQkGaQttuQtv+Q2/+2ZgC2Zjq2kDq229u22/+2/7a2///bkDrbkGbbtmbbtpDb2//b////tmb/25D/27b//7b//9v///+JOPOeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIfklEQVR4nO2dDVudNhiGY1s9+17dutZu3XDrRrt5rIf//+cGBA5wJHlCkhcCPPd16aWekMTbN8mLxqAKYkUt3YHUoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggCpCsrUi38GXzjdK3X1y8P581zV3Eh3ZC2CTncXPjIKGgjK1dWH4pNS75rPn27V61k6koigT1+XA+j7j9WHp/uDevWhEvR40FGirv4oA+imDqM2YsrX3lnqi0cagpoJpQqaZiypoaAmYDJ13cxCR6W+Uerbj+JdS0JQ+e3fPBSfVSWh/M5vHqoZeSCo/FALagde1r4i3bckBJXf/qu/mo+1g1LZYA66FHT69fDqY/Hv4RxRYiQhSA+rl9Ui3k4zmV1QQy4fQkkIKr78rAfM7/Voq76SgSGmOe5FUKnot3IdKwdMGUH1qMnAJK3ZkaCS0/sqPnpz0HCZL9V0y/zjm8NYRAmQhKBy5frxoRpnpQS9imXq+WzzVieKtavyXZk4fj7sJZO+7y3a2TkP6pfobjV0MDXRJb6IJSKo+FzNQDrtO/15UC/fjtysHvTNajNLfXlTCv1B3E8qgtKFggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYDIgtRqWEpQ3OoEaNxQkAHVe3O+IHL7KaPa95KCjpZ/kdi7oEyp14/fPRRPt4b/Rdq5oOz6ocjq6MkN+2/TFtRbwUQE1XHz+FUl6DjcpDt99ZybtnvCgqrt/6f/ivVF0NlPoZTgEMvbuNGqQqubj4v4kZukc718HY3/L5qmIDWboLmri0OjpnljonhJL3i6hYSCOkZvUSnozHgKQkEthhSNghoG2WH/684VRO5P3OqC6Zb3yxeca4jcobjVhWK+BaKgCsstIgUV9ltoCiooCGH9HczMgqx9WQh7nxhB4Ge2d0Gj91+DAs41ReuTRHWeKOhn34Ic/OxakIufPQty8rNfQcrNz24FOerZrSBXPXsV5KyHgnBR5zqDeiRd3cTGJ9wR7luQS1nnSgM6JF/dtLYn+JHa3dEFseGAx+UETRlfhVQEne5MXqb1ToAJC5gu71zxpG6c7sDJl0sJmupHbA4yb3zxqi4S7vlhd4lz3Z59mqc6x0an+9mVIB8/XoLqRSrw9NgFBHn58RF01Pt7w06wnl+Qlx4fQac7Pf1mQTE0uyBPPx6Cnn7SoXMMOuN7bkG+fgIiyLQDOnK7cfBPUH3moDrFycOeCDOrIO/wKbyGGL7RitluBEL87CEPCvKzL0FeV3sUXFeiGOZn+4lioJ/NJ4qhfuZOFIP7O3t7G08Uw38e204UI8TrphPFGON5y3lQlAlvF4KCKvEomNVP9wp7vOsMguIsmB6CdAL0dBv0SLMZBQXWMrlge9pE6r8wi5Rx+eRBenDlSQuKlpF6DDGdAT0egiYhYUFqSUH6sYGBj+WUFRTPzyZ3d6iIfube3eFX3TSi+tng7o64fra3uyOyn7lvNeJ2fo4WNncvFvsnICmoTSkjVedE9AjdmKD4I3hbggSmuI0Kilhl9IIdswuSWCI3tYpJpBAbEiSTY21HkFAOuhlBke8wunqjF1ykOjE/GxEU+w61X3X0gvNXpwT9bEGQqJ8NCJL1s/rfBylhP2uPIHE/6xYkr2e1gtQz4nRrpKXoBcWra4TM42dlgjoxhZLMDvtNRi8oVF1PxrMIitu1i3ajF4xbnbo4Zr54Lihux551IHrB8OrO37X+oNHSftaMLpHfjk3sqF/BwOra8Ch60dMc89wIOrsZOf05PpKCpj4dqjfL6JFU9COmEzRH4Fg7GlawxufpUL35t51yzoKKzs0scWPtaGDBiulPhxpOvOc5+Rw8xQJuRjsaXrCwPR3qeXVDJZcL1mAVWwQhQc5Ph+pne/0F/PzihGZFkBlizk+HGkw4sy3dUxCapE1Phxpmv82M3E3Eqdkpls2DWjW9uSc9JAWBv80PcsEEY0ezsKA0h1WfpQUlOrA6FhR0fkuaJQUlHz0Vyd3Np8ZiglbDQoKc6w18Xfhyv6KToKDAeilI9nUKoqCw1ymIgsJep6DNC9oMFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCAlqDoQDRzGZDu5+nSnlPHMS9suUnQtbvoCIUHH6wd0ZuXRcjz86a40kBsMV0enH82GrNfipi+REaT/Om09kvHp1tLLx8M74/W67swowHatQ9OXyAjSOz2t5NfvUS/HwwQLMF/r3HSHjKDji79v7fNAqRBOBNmoBPs2W/u1zk13yAjKq3MWbUfmVeME9dJwMrGODVuEmK91bbqHkKAr8FOuthGDXh4tczQSZLrWsek+QoJqNXq2GKMeJvZeGmPAYYjZTsV2aHpAdEF5lYTo7o9O1fXrebMHZURgrpOY3Pg94knafG1Tv6HpUWQiSP+zC5hIbT9Gy8MZ0DLv8mCHxYdYPdBtW/UqLL20HtoMEkWXA5+XF1TdDqDj8S29bMaBwUJuvdWwXwubvoQ3qwAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIG1B9Y5e/Fd+SVIXVO9yQU93lWQVguADggVZhaAp21ViswpBjCATjRmHTXVipC5o2o5LAVIXdFNtOlxugK1CkHXbszhrENQcE78MqxD0dMtlfpx2fbfunZclbUEJQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAf4HB0jx8hH5vygAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">qqplot</span>(rw3<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],cpp.rw3<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],<span class="dt">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=2&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">qqplot</span>(rw4<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],cpp.rw4<span class="op">$</span>x[<span class="dv">500</span><span class="op">:</span><span class="dv">2000</span>],<span class="dt">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="dt">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="dt">main=</span><span class="st">&#39;sd=16&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the qqplots show, the distributions of the random numbers are similiar when sd = 0.5 or 2, when sd = 0.05, since both distributions are not stable so that they are not similiar, when sd = 16, Although most of the candidates are rejected, however, they are also similar in the interval [-2,2].</p>
</div>
<div id="question3" class="section level1">
<h1>Question3</h1>
<p>Campare the computation time of the two functions with microbenchmark.</p>
</div>
<div id="solution-3" class="section level1">
<h1>Solution 3</h1>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb97-2" title="2">ts1&lt;-<span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(<span class="fl">0.05</span>,<span class="dv">25</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">Metropolis</span>(<span class="fl">0.05</span>,<span class="dv">25</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb97-3" title="3"></a>
<a class="sourceLine" id="cb97-4" title="4">ts2&lt;-<span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(<span class="fl">0.5</span>,<span class="dv">25</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">Metropolis</span>(<span class="fl">0.5</span>,<span class="dv">25</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb97-5" title="5"></a>
<a class="sourceLine" id="cb97-6" title="6">ts3&lt;-<span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(<span class="dv">2</span>,<span class="dv">25</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">Metropolis</span>(<span class="dv">2</span>,<span class="dv">25</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb97-7" title="7"></a>
<a class="sourceLine" id="cb97-8" title="8">ts4&lt;-<span class="kw">microbenchmark</span>(<span class="dt">R=</span><span class="kw">rw.Metropolis</span>(<span class="dv">16</span>,<span class="dv">25</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">Metropolis</span>(<span class="dv">16</span>,<span class="dv">25</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb97-9" title="9"></a>
<a class="sourceLine" id="cb97-10" title="10"><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq  median       uq
## 1    R 6778.35 6924.35 12790.75
## 2  cpp  260.70  271.55   427.55</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr     lq  median      uq
## 1    R 6990.9 7429.65 7896.35
## 2  cpp  288.5  299.80  305.40</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq median      uq
## 1    R 6956.05 7318.6 7966.15
## 2  cpp  335.05  344.4  347.85</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr     lq median      uq
## 1    R 6965.5 7151.5 7835.25
## 2  cpp  337.2  345.8  351.65</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
